@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix qudt: <http://qudt.org/schema/qudt/> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix ref: <https://brickschema.org/schema/Brick/ref#> .
@prefix s223: <http://data.ashrae.org/standard223#> .
@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix spin: <http://spinrdf.org/spin#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .

s223:Class a rdfs:Class,
        sh:NodeShape ;
    rdfs:label "Class" ;
    rdfs:subClassOf rdfs:Class ;
    sh:property [ rdfs:comment "This Class must have a label" ;
            sh:path rdfs:label ;
            sh:sparql [ a sh:SPARQLConstraint ;
                    sh:message "{$this} must have an rdfs:label" ;
                    sh:prefixes <http://data.ashrae.org/standard223/1.0/validation/schema> ;
                    sh:select """
SELECT $this
WHERE {
FILTER (NOT EXISTS {$this rdfs:label ?something}) .
}
""" ] ] .

s223:AHU a s223:Class,
        sh:NodeShape ;
    rdfs:label "AHU" ;
    rdfs:subClassOf s223:Equipment .

s223:Actuator a s223:Class,
        sh:NodeShape ;
    rdfs:label "Actuator" ;
    rdfs:subClassOf s223:Equipment ;
    sh:property [ rdfs:comment "An instance of Actuator must be associated with any number of actuatable property instances using the relation 'commanded by Property'." ;
            sh:class s223:ActuatableProperty ;
            sh:minCount 1 ;
            sh:path s223:commandedByProperty ],
        [ sh:class s223:Equipment ;
            sh:path s223:actuates ] .

s223:BidirectionalConnectionPoint a s223:Class,
        sh:NodeShape ;
    rdfs:label "Bidirectional Connection Point" ;
    rdfs:comment "A BidirectionalConnectionPoint is a predefined subclass of ConnectionPoint. The use of a BidirectionalConnectionPoint implies that the direction of flow is not fixed in one direction. It depends on the status of some other part of the system, such as a valve position, that is expected to change during operation (see `s223:Direction-Bidirectional`) or to model energy transfer occuring without specific flow direction." ;
    rdfs:subClassOf s223:ConnectionPoint .

s223:Binary-False a s223:EnumerationKind-Binary ;
    rdfs:label "Binary False" .

s223:Binary-True a s223:EnumerationKind-Binary ;
    rdfs:label "Binary True" .

s223:Binary-Unknown a s223:EnumerationKind-Binary ;
    rdfs:label "Binary Unknown" .

s223:Boiler a s223:Class,
        sh:NodeShape ;
    rdfs:label "Boiler" ;
    rdfs:subClassOf s223:Equipment .

s223:Chiller a s223:Class,
        sh:NodeShape ;
    rdfs:label "Chiller" ;
    rdfs:subClassOf s223:Equipment .

s223:Compressor a s223:Class,
        sh:NodeShape ;
    rdfs:label "Compressor" ;
    rdfs:subClassOf s223:Equipment .

s223:ConcentrationSensor a s223:Class,
        sh:NodeShape ;
    rdfs:label "Concentration sensor" ;
    rdfs:comment "A ConcentrationSensor is a specialization of a Sensor that observes a QuantifiableObservableProperty that represents the concentration of a substance in a medium." ;
    rdfs:subClassOf s223:Sensor .

s223:Controller a s223:Class,
        sh:NodeShape ;
    rdfs:label "Controller" ;
    rdfs:subClassOf s223:Equipment ;
    sh:property [ rdfs:comment "An instance of Controller can be associated with any number of Function block instances using the relation 'executes'." ;
            sh:class s223:FunctionBlock ;
            sh:path s223:executes ] .

s223:CoolingCoil a s223:Class,
        sh:NodeShape ;
    rdfs:label "Cooling coil" ;
    rdfs:subClassOf s223:Coil .

s223:CorrelatedColorTemperatureSensor a s223:Class,
        sh:NodeShape ;
    rdfs:label "Correlated color temperature sensor" ;
    rdfs:subClassOf s223:LightSensor ;
    sh:rule [ a sh:SPARQLRule ;
            rdfs:comment "A CorrelatedColorTemperatureSensor will always observe a Property that has a QuantityKind of ThermodynamicTemperature." ;
            sh:construct """
CONSTRUCT {?prop qudt:hasQuantityKind qudtqk:ThermodynamicTemperature .}
WHERE {
  $this s223:observesProperty ?prop .
}
""" ;
            sh:prefixes <http://data.ashrae.org/standard223/1.0/inference/model-rules> ] .

s223:DifferentialSensor a s223:Class,
        sh:NodeShape ;
    rdfs:label "Differential sensor" ;
    rdfs:subClassOf s223:AbstractSensor ;
    sh:property [ rdfs:comment "A DifferentialSensor must be related by s223:hasMeasurementLocationHigh to exactly one measurement location" ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path s223:hasMeasurementLocationLow ;
            sh:xone ( [ sh:class s223:Connectable ] [ sh:class s223:Connection ] [ sh:class s223:Segment ] [ sh:class s223:ConnectionPoint ] ) ],
        [ rdfs:comment "A Differential Sensor must be defined in terms of the QuantityKind that is being measured" ;
            sh:class qudt:QuantityKind ;
            sh:minCount 1 ;
            sh:path ( s223:observesProperty qudt:hasQuantityKind ) ],
        [ rdfs:comment "A DifferentialSensor must be related by s223:hasMeasurementLocationHigh to exactly one measurement location" ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path s223:hasMeasurementLocationHigh ;
            sh:xone ( [ sh:class s223:Connectable ] [ sh:class s223:Connection ] [ sh:class s223:Segment ] [ sh:class s223:ConnectionPoint ] ) ],
        [ rdfs:comment "Ensure that the values of hasMeasurementLocationHigh and hasMeasurementLocationLow are distinct." ;
            sh:path s223:hasMeasurementLocationHigh ;
            sh:sparql [ a sh:SPARQLConstraint ;
                    rdfs:comment "Ensure that the values of hasMeasurementLocationHigh and hasMeasurementLocationLow are distinct." ;
                    sh:message "{$this} cannot have the same value, {?high}, for both hasMeasurementLocationHigh and hasMeasurementLocationLow" ;
                    sh:prefixes <http://data.ashrae.org/standard223/1.0/validation/model> ;
                    sh:select """
SELECT $this ?high
WHERE {
  ?this s223:hasMeasurementLocationHigh ?high .
    ?this s223:hasMeasurementLocationLow ?low .
FILTER (?high = ?low) .
}
""" ] ] .

s223:Direction-Bidirectional a s223:EnumerationKind-Direction ;
    rdfs:label "Direction-Bidirectional" ;
    rdfs:comment "One of the  set of enumeration values for the hasDirection property used to characterize the direction of flow associated with an instance of a ConnectionPoint. The value Bidirectional indicates that the direction of flow is not fixed in one direction. It depends on the status of some other part of the system, such as a valve position, that is expected to change during operation." .

s223:Direction-Inlet a s223:EnumerationKind-Direction ;
    rdfs:label "Direction-Inlet"@en ;
    rdfs:comment "One of the set of enumeration values for the hasDirection property used to characterize the direction of flow associated with an instance of a ConnectionPoint. The value Inlet indicates that the direction of flow is into the Equipment." .

s223:Direction-Outlet a s223:EnumerationKind-Direction ;
    rdfs:label "Direction-Outlet"@en,
        "Direction-Sortie"@fr ;
    rdfs:comment "One member of the enumerated valid values to characterize the hasDirection property. It is an instance of the Direction class." .

s223:Domain-ConveyanceSystems a s223:EnumerationKind-Domain ;
    rdfs:label "Domain-ConveyanceSystems" ;
    rdfs:comment "The domain ConveyanceSystems represents equipment used to move people or things from one place in a building to another. Example equipment that might fall within a ConveyanceSystems domain include elevators, escalators, and conveyer belts." .

s223:Domain-Electrical a s223:EnumerationKind-Domain ;
    rdfs:label "Domain-Electrical" ;
    rdfs:comment "The domain Electrical represents equipment used to provide electrical power within a building. Example equipment that might fall within an Electrical domain include breaker panels, switchgear, photovoltaic panels, and generators. " .

s223:Domain-Fire a s223:EnumerationKind-Domain ;
    rdfs:label "Domain-Fire" ;
    rdfs:comment "The domain Fire represents equipment used to provide fire detection and protection within a building. Example equipment that might be fall within a Fire domain include smoke detectors, alarm annunciators, and emergency public address systems. " .

s223:Domain-HVAC a s223:EnumerationKind-Domain ;
    rdfs:label "Domain-HVAC" ;
    rdfs:comment "The domain HVAC represents equipment used to provide space conditioning and ventilation within a building. Example equipment that might fall within an HVAC domain include fans, pumps, air-handling units, and variable air volume boxes. " .

s223:Domain-Lighting a s223:EnumerationKind-Domain ;
    rdfs:label "Domain-Lighting" ;
    rdfs:comment "The domain Lighting represents equipment used to provide illumination within or outside a building. Example equipment that might fall within a Lighting domain include luminaires, daylight sensors, and movable sun shades." .

s223:Domain-Networking a s223:EnumerationKind-Domain ;
    rdfs:label "Domain-Networking" .

s223:Domain-Occupancy a s223:EnumerationKind-Domain ;
    rdfs:label "Domain-Occupancy" .

s223:Domain-PhysicalSecurity a s223:EnumerationKind-Domain ;
    rdfs:label "Domain-PhysicalSecurity" ;
    rdfs:comment "The domain Security represents equipment used to provide physical access control within or outside a building. Example equipment that might fall within a PhysicalSecurity domain include cameras, keycard sensors, and biometric scanners." .

s223:Domain-Plumbing a s223:EnumerationKind-Domain ;
    rdfs:label "Domain-Plumbing" ;
    rdfs:comment "The domain Plumbing represents equipment used to provide domestic water within or outside a building. Example equipment that might fall within a Plumbing domain include water meters, domestic hot water tanks, and sinks." .

s223:Domain-Refrigeration a s223:EnumerationKind-Domain ;
    rdfs:label "Domain-Refrigeration" .

s223:Door a s223:Class,
        sh:NodeShape ;
    rdfs:label "Door" ;
    rdfs:subClassOf s223:Equipment .

s223:DuvSensor a s223:Class,
        sh:NodeShape ;
    rdfs:label "Duv sensor" ;
    rdfs:subClassOf s223:LightSensor ;
    sh:rule [ a sh:SPARQLRule ;
            rdfs:comment "A DuvSensor will always observe a Property that has a QuantityKind of Duv." ;
            sh:construct """
CONSTRUCT {?prop qudt:hasQuantityKind qudtqk:Duv .}
WHERE {
  $this s223:observesProperty ?prop .
}
""" ;
            sh:prefixes <http://data.ashrae.org/standard223/1.0/inference/model-rules> ] .

s223:Economizer a s223:Class,
        sh:NodeShape ;
    rdfs:label "Economizer" ;
    rdfs:subClassOf s223:Equipment .

s223:Effectiveness-Active a s223:EnumerationKind-Effectiveness ;
    rdfs:label "Active" .

s223:ElectricBreaker a s223:Class,
        sh:NodeShape ;
    rdfs:label "Electric breaker" ;
    rdfs:subClassOf s223:Equipment .

s223:ElectricMeter a s223:Class,
        sh:NodeShape ;
    rdfs:label "Electric meter" ;
    rdfs:subClassOf s223:Equipment .

s223:ElectricWire a s223:Class,
        sh:NodeShape ;
    rdfs:label "Electric wire" ;
    rdfs:subClassOf s223:Connection .

s223:Electricity-120V-240V-60Hz a s223:Medium-Electricity ;
    rdfs:label "Electricity-120V-240V-60Hz" .

s223:Electricity-120V-60Hz a s223:Medium-Electricity ;
    rdfs:label "Electricity-120V-60Hz" .

s223:Electricity-208V-60Hz a s223:Medium-Electricity ;
    rdfs:label "Electricity-208V-60Hz" .

s223:Electricity-240V-60Hz a s223:Medium-Electricity ;
    rdfs:label "Electricity-240V-60Hz" .

s223:Electricity-277V-60Hz a s223:Medium-Electricity ;
    rdfs:label "Electricity-277V-60Hz" .

s223:Electricity-347V-60Hz a s223:Medium-Electricity ;
    rdfs:label "Electricity-347V-60Hz" .

s223:Electricity-480V-60Hz a s223:Medium-Electricity ;
    rdfs:label "Electricity-480V-60Hz" .

s223:Electricity-575V-60Hz a s223:Medium-Electricity ;
    rdfs:label "Electricity-575V-60Hz" .

s223:EnumeratedActuatableProperty a s223:Class,
        sh:NodeShape ;
    rdfs:label "Enumerated actuatable property" ;
    rdfs:comment "An EnumeratedActuatableProperty is a property with an enumerated (fixed) set of possible values that can be changed (actuated)" ;
    rdfs:subClassOf s223:ActuatableProperty,
        s223:EnumerableProperty .

s223:EnumeratedObservableProperty a s223:Class,
        sh:NodeShape ;
    rdfs:label "Enumerated observable property" ;
    rdfs:comment "An EnumeratedActuatableProperty is a property with an enumerated (fixed) set of possible values that can only be observed (not changed)" ;
    rdfs:subClassOf s223:EnumerableProperty,
        s223:ObservableProperty .

s223:ExternalSource a s223:Class,
        sh:NodeShape ;
    rdfs:label "External source" ;
    rdfs:subClassOf s223:Concept .

s223:Fan a s223:Class,
        sh:NodeShape ;
    rdfs:label "Fan" ;
    rdfs:subClassOf s223:FlowEquipment ;
    sh:property [ a sh:PropertyShape ;
            rdfs:comment "A Fan must be associated with at least two ConnectionPoints by hasConnectionPoint" ;
            sh:class s223:ConnectionPoint ;
            sh:minCount 2 ;
            sh:name "Air inlet point" ;
            sh:path s223:hasConnectionPoint ] .

s223:FlowSensor a s223:Class,
        sh:NodeShape ;
    rdfs:label "Flow sensor" ;
    rdfs:comment "A FlowSensor is a specialization of a Sensor that produces an ObservableProperty that is quantifiable and represents a flow measurement. " ;
    rdfs:subClassOf s223:Sensor .

s223:HVACOperatingMode-Auto a s223:EnumerationKind-HVACOperatingMode ;
    rdfs:label "Auto" .

s223:HVACOperatingMode-CoolOnly a s223:EnumerationKind-HVACOperatingMode ;
    rdfs:label "CoolOnly" .

s223:HVACOperatingMode-FanOnly a s223:EnumerationKind-HVACOperatingMode ;
    rdfs:label "FanOnly" .

s223:HVACOperatingMode-HeatOnly a s223:EnumerationKind-HVACOperatingMode ;
    rdfs:label "HeatOnly" .

s223:HVACOperatingMode-Off a s223:EnumerationKind-HVACOperatingMode ;
    rdfs:label "Off" .

s223:HVACOperatingStatus-Cooling a s223:EnumerationKind-HVACOperatingStatus ;
    rdfs:label "Cooling" .

s223:HVACOperatingStatus-Dehumidifying a s223:EnumerationKind-HVACOperatingStatus ;
    rdfs:label "Dehumidifying" .

s223:HVACOperatingStatus-Heating a s223:EnumerationKind-HVACOperatingStatus ;
    rdfs:label "Heating" .

s223:HVACOperatingStatus-Off a s223:EnumerationKind-HVACOperatingStatus ;
    rdfs:label "Off" .

s223:HVACOperatingStatus-Ventilating a s223:EnumerationKind-HVACOperatingStatus ;
    rdfs:label "Ventilating" .

s223:HasDomainLookingUpRule a sh:NodeShape ;
    sh:rule [ a sh:TripleRule ;
            rdfs:comment "Traverse up the contains hierarchy to determine the domain" ;
            sh:object [ sh:path ( [ sh:zeroOrMorePath [ sh:inversePath s223:contains ] ] s223:hasDomain ) ] ;
            sh:predicate s223:hasDomain ;
            sh:subject sh:this ] ;
    sh:targetClass s223:DomainSpace,
        s223:Zone .

s223:HeatExchanger-Condenser a s223:Role-HeatExchanger ;
    rdfs:label "Condenser" .

s223:HeatExchanger-Evaporator a s223:Role-HeatExchanger ;
    rdfs:label "Evaporator" .

s223:HeatingCoil a s223:Class,
        sh:NodeShape ;
    rdfs:label "Heating coil" ;
    rdfs:subClassOf s223:Coil .

s223:Humidifier a s223:Class,
        sh:NodeShape ;
    rdfs:label "Humidifier" ;
    rdfs:subClassOf s223:Equipment .

s223:HumiditySensor a s223:Class,
        sh:NodeShape ;
    rdfs:label "Humidity sensor" ;
    rdfs:comment "A HumiditySensor is a specialization of a Sensor that observes a QuantifiableObservableProperty that represents a humidity measurement. " ;
    rdfs:subClassOf s223:Sensor .

s223:IlluminanceSensor a s223:Class,
        sh:NodeShape ;
    rdfs:label "Illuminance sensor" ;
    rdfs:subClassOf s223:LightSensor ;
    sh:rule [ a sh:SPARQLRule ;
            rdfs:comment "A IlluminanceSensor will always observe a Property that has a QuantityKind of Illuminance." ;
            sh:construct """
CONSTRUCT {?prop qudt:hasQuantityKind qudtqk:Illuminance .}
WHERE {
  $this s223:observesProperty ?prop .
}
""" ;
            sh:prefixes <http://data.ashrae.org/standard223/1.0/inference/model-rules> ] .

s223:InversePropertyShape a sh:NodeShape ;
    sh:rule [ a sh:SPARQLRule ;
            rdfs:comment "Declare the inverse triples for relations that have defined inverse relations" ;
            sh:construct """
CONSTRUCT {
?o ?invP $this .
}
WHERE {
  $this ?p ?o .
  ?p s223:inverseOf ?invP .
}
			""" ;
            sh:prefixes <http://data.ashrae.org/standard223/1.0/inference/owl-subset> ] ;
    sh:targetClass s223:Concept .

s223:Inverter a s223:Class,
        sh:NodeShape ;
    rdfs:label "Inverter" ;
    rdfs:subClassOf s223:Equipment .

s223:Light-Infrared a s223:Medium-Light ;
    rdfs:label "Light-Infrared" .

s223:Light-Visible a s223:Medium-Light ;
    rdfs:label "Light-Visible" .

s223:Luminaire a s223:Class,
        sh:NodeShape ;
    rdfs:label "Luminaire" ;
    rdfs:subClassOf s223:Equipment .

s223:ManualDamper a s223:Class ;
    rdfs:label "Manual damper" ;
    rdfs:subClassOf s223:Damper .

s223:MeasuredPropertyRule a sh:NodeShape ;
    rdfs:comment "Associate the object of hasMeasurementLocation directly with the observed Property." ;
    sh:rule [ a sh:TripleRule ;
            rdfs:comment "Associate the object of hasMeasurementLocation directly with the observed Property." ;
            sh:object [ sh:path ( [ sh:inversePath s223:hasMeasurementLocation ] s223:observesProperty ) ] ;
            sh:predicate s223:hasProperty ;
            sh:subject sh:this ] ;
    sh:targetClass s223:Concept .

s223:Medium-Air a s223:EnumerationKind-Medium ;
    rdfs:label "Medium-Air" .

s223:Medium-Glycol a s223:EnumerationKind-Medium ;
    rdfs:label "Medium-Glycol" .

s223:Motion-False a s223:Occupancy-Motion ;
    rdfs:label "Motion-False" .

s223:Motion-True a s223:Occupancy-Motion ;
    rdfs:label "Motion-True" .

s223:MotorizedDamper a s223:Class ;
    rdfs:label "Motorized damper" ;
    rdfs:subClassOf s223:Damper .

s223:MotorizedThreeWayValve a s223:Class,
        sh:NodeShape ;
    rdfs:label "Motorized three way valve" ;
    rdfs:subClassOf s223:MotorizedValve .

s223:MotorizedTwoWayValve a s223:Class,
        sh:NodeShape ;
    rdfs:label "Motorized two way valve" ;
    rdfs:subClassOf s223:MotorizedValve .

s223:Occupancy-Occupied a s223:EnumerationKind-Occupancy ;
    rdfs:label "Occupied" .

s223:Occupancy-Unknown a s223:EnumerationKind-Occupancy ;
    rdfs:label "Unknown" .

s223:Occupancy-Unoccupied a s223:EnumerationKind-Occupancy ;
    rdfs:label "Unoccupied" .

s223:OccupantCounter a s223:Class,
        sh:NodeShape ;
    rdfs:label "Occupant counter" ;
    rdfs:subClassOf s223:OccupancySensor ;
    sh:rule [ a sh:SPARQLRule ;
            rdfs:comment "A OccupantCounter will always observe a Property that has a QuantityKind of Population." ;
            sh:construct """
CONSTRUCT {?prop qudt:hasQuantityKind qudtqk:Population .
?prop qudt:unit unit:NUM .}
WHERE {
  $this s223:observesProperty ?prop .
}
""" ;
            sh:prefixes <http://data.ashrae.org/standard223/1.0/inference/model-rules> ] .

s223:OccupantMotionSensor a s223:Class,
        sh:NodeShape ;
    rdfs:label "Occupant motion sensor" ;
    rdfs:subClassOf s223:OccupancySensor ;
    sh:rule [ a sh:SPARQLRule ;
            rdfs:comment "A OccupantMotionSensor will always observe a Property that has an EnumerationKind of Occupancy-Motion." ;
            sh:construct """
CONSTRUCT {?prop s223:hasEnumerationKind s223:Occupancy-Motion .}
WHERE {
  $this s223:observesProperty ?prop .
}
""" ;
            sh:prefixes <http://data.ashrae.org/standard223/1.0/inference/model-rules> ] .

s223:OccupantPresenceSensor a s223:Class,
        sh:NodeShape ;
    rdfs:label "Occupant presence sensor" ;
    rdfs:subClassOf s223:OccupancySensor ;
    sh:rule [ a sh:SPARQLRule ;
            rdfs:comment "A OccupantPresenceSensor will always observe a Property that has an EnumerationKind of Occupancy-Presence." ;
            sh:construct """
CONSTRUCT {?prop s223:hasEnumerationKind s223:Occupancy-Presence .}
WHERE {
  $this s223:observesProperty ?prop .
}
""" ;
            sh:prefixes <http://data.ashrae.org/standard223/1.0/inference/model-rules> ] .

s223:OnOff-Off a s223:EnumerationKind-OnOff ;
    rdfs:label "Off" .

s223:OnOff-On a s223:EnumerationKind-OnOff ;
    rdfs:label "On" .

s223:OnOff-Unknown a s223:EnumerationKind-OnOff ;
    rdfs:label "Unknown" .

s223:Particulate-PM1.0 a s223:Substance-Particulate ;
    rdfs:label "Particulate-PM1.0" .

s223:Particulate-PM10.0 a s223:Substance-Particulate ;
    rdfs:label "Particulate-PM10.0" .

s223:Particulate-PM2.5 a s223:Substance-Particulate ;
    rdfs:label "Particulate-PM2.5" .

s223:ParticulateSensor a s223:Class,
        sh:NodeShape ;
    rdfs:label "Particulate sensor" ;
    rdfs:comment "A ParticulateSensor is a specialization of a Sensor that observes a QuantifiableObservableProperty that represents a particulate concentration measurement." ;
    rdfs:subClassOf s223:Sensor ;
    sh:property [ rdfs:comment "A ParticulateSensor can be associated with a Substance-Particulate by measuresSubstance" ;
            sh:class s223:Substance-Particulate ;
            sh:path s223:measuresSubstance ] .

s223:PositionStatus-Closed a s223:EnumerationKind-PositionStatus ;
    rdfs:label "Closed" .

s223:PositionStatus-Open a s223:EnumerationKind-PositionStatus ;
    rdfs:label "Open" .

s223:PositionStatus-Unknown a s223:EnumerationKind-PositionStatus ;
    rdfs:label "Unknown" .

s223:Presence-False a s223:Occupancy-Presence ;
    rdfs:label "Presence-False" .

s223:Presence-True a s223:Occupancy-Presence ;
    rdfs:label "Presence-True" .

s223:PressureSensor a s223:Class,
        sh:NodeShape ;
    rdfs:label "Pressure sensor" ;
    rdfs:comment "A PressureSensor is a specialization of a Sensor that observes a QuantifiableObservableProperty that represents a pressure measurement." ;
    rdfs:subClassOf s223:Sensor .

s223:Pump a s223:Class,
        sh:NodeShape ;
    rdfs:label "Pump" ;
    rdfs:subClassOf s223:FlowEquipment .

s223:QuantifiableActuatableProperty a s223:Class,
        sh:NodeShape ;
    rdfs:label "Quantifiable Actuatable Property" ;
    rdfs:comment "This class is for quantifiable properties of which numerical values are specified to be modifiable by a user or a machine outside of the model, like a setpoint." ;
    rdfs:subClassOf s223:ActuatableProperty,
        s223:QuantifiableProperty .

s223:QuantifiableObservableProperty a s223:Class,
        sh:NodeShape ;
    rdfs:label "Quantifiable Observable Property" ;
    rdfs:comment "This class is for quantifiable properties of which numerical values cannot be modified by a user or a machine outside of the model, but only observed, like a temperature reading or a voltage measure." ;
    rdfs:subClassOf s223:ObservableProperty,
        s223:QuantifiableProperty .

s223:Role-Cooling a s223:EnumerationKind-Role ;
    rdfs:label "Role-Cooling" .

s223:Role-Discharge a s223:EnumerationKind-Role ;
    rdfs:label "Role-Discharge" .

s223:Role-Exhaust a s223:EnumerationKind-Role ;
    rdfs:label "Role-Exhaust" .

s223:Role-Generator a s223:EnumerationKind-Role ;
    rdfs:label "Role-Generator" .

s223:Role-Heating a s223:EnumerationKind-Role ;
    rdfs:label "Role-Heating" .

s223:Role-Load a s223:EnumerationKind-Role ;
    rdfs:label "Role-Load" .

s223:Role-Primary a s223:EnumerationKind-Role ;
    rdfs:label "Role-Primary" .

s223:Role-Recirculating a s223:EnumerationKind-Role ;
    rdfs:label "Role-Recirculating" .

s223:Role-Return a s223:EnumerationKind-Role ;
    rdfs:label "Role-Return" .

s223:Role-Secondary a s223:EnumerationKind-Role ;
    rdfs:label "Role-Secondary" .

s223:Role-Supply a s223:EnumerationKind-Role ;
    rdfs:label "Role-Supply" .

s223:RunStatus-Off a s223:EnumerationKind-RunStatus ;
    rdfs:label "Off" .

s223:RunStatus-On a s223:EnumerationKind-RunStatus ;
    rdfs:label "On" .

s223:RunStatus-Unknown a s223:EnumerationKind-RunStatus ;
    rdfs:label "Unknown" .

s223:State a s223:Class,
        sh:NodeShape ;
    rdfs:label "State" ;
    rdfs:subClassOf s223:Concept .

s223:StorageTank a s223:Class,
        sh:NodeShape ;
    rdfs:label "Storage tank" ;
    rdfs:subClassOf s223:Equipment .

s223:Substance-CO a s223:EnumerationKind-Substance ;
    rdfs:label "Substance-CO" .

s223:Substance-CO2 a s223:EnumerationKind-Substance ;
    rdfs:label "Substance-CO2" .

s223:Substance-Soot a s223:EnumerationKind-Substance ;
    rdfs:label "Substance-Soot" .

s223:SymmetricPropertyShape a sh:NodeShape ;
    sh:rule [ a sh:SPARQLRule ;
            rdfs:comment "Declare the inverse triples for symmetric relations" ;
            sh:construct """
CONSTRUCT {
?o ?p $this .
}
WHERE {
  $this ?p ?o .
  ?p a s223:SymmetricProperty .
}
			""" ;
            sh:prefixes <http://data.ashrae.org/standard223/1.0/inference/owl-subset> ] ;
    sh:targetClass s223:Concept .

s223:TemperatureSensor a s223:Class,
        sh:NodeShape ;
    rdfs:label "Temp sensor" ;
    rdfs:comment "A TemperatureSensor is a specialization of a Sensor that observes a QuantifiableObservableProperty that represents a temperature measurement." ;
    rdfs:subClassOf s223:Sensor ;
    sh:rule [ a sh:SPARQLRule ;
            rdfs:comment "A TemperatureSensor will always observe a Property that has a QuantityKind of Temperature." ;
            sh:construct """
CONSTRUCT {?prop qudt:hasQuantityKind qudtqk:Temperature .}
WHERE {
  $this s223:observesProperty ?prop .
}
""" ;
            sh:prefixes <http://data.ashrae.org/standard223/1.0/inference/model-rules> ] .

s223:Thermostat a s223:Class,
        sh:NodeShape ;
    rdfs:label "Thermostat" ;
    rdfs:subClassOf s223:Equipment .

s223:ThreeSpeedSetting-High a s223:EnumerationKind-ThreeSpeedSetting ;
    rdfs:label "High" .

s223:ThreeSpeedSetting-Low a s223:EnumerationKind-ThreeSpeedSetting ;
    rdfs:label "Low" .

s223:ThreeSpeedSetting-Medium a s223:EnumerationKind-ThreeSpeedSetting ;
    rdfs:label "Medium" .

s223:ThreeSpeedSetting-Off a s223:EnumerationKind-ThreeSpeedSetting ;
    rdfs:label "Off" .

s223:ThreeWayValve a s223:Class,
        sh:NodeShape ;
    rdfs:label "Three way valve" ;
    rdfs:subClassOf s223:ManualValve .

s223:TwoWayValve a s223:Class,
        sh:NodeShape ;
    rdfs:label "Two way valve" ;
    rdfs:subClassOf s223:ManualValve .

s223:VAV a s223:Class,
        sh:NodeShape ;
    rdfs:label "VAV" ;
    rdfs:subClassOf s223:Equipment .

s223:VFD a s223:Class,
        sh:NodeShape ;
    rdfs:label "VFD" ;
    rdfs:subClassOf s223:Equipment .

s223:Water-ChilledWater a s223:Medium-Water ;
    rdfs:label "Water-Chilled water" .

s223:Water-HotWater a s223:Medium-Water ;
    rdfs:label "Water-Hot water" .

s223:Weekday-Friday a s223:DayOfWeek-Weekday ;
    rdfs:label "Friday" .

s223:Weekday-Monday a s223:DayOfWeek-Weekday ;
    rdfs:label "Monday" .

s223:Weekday-Thursday a s223:DayOfWeek-Weekday ;
    rdfs:label "Thursday" .

s223:Weekday-Tuesday a s223:DayOfWeek-Weekday ;
    rdfs:label "Tuesday" .

s223:Weekday-Wednesday a s223:DayOfWeek-Weekday ;
    rdfs:label "Wednesday" .

s223:Weekend-Saturday a s223:DayOfWeek-Weekend ;
    rdfs:label "Saturday" .

s223:Weekend-Sunday a s223:DayOfWeek-Weekend ;
    rdfs:label "Sunday" .

s223:Window a s223:Class,
        sh:NodeShape ;
    rdfs:label "Window" ;
    rdfs:subClassOf s223:Equipment .

s223:abstract a rdf:Property ;
    rdfs:label "abstract" ;
    rdfs:range xsd:boolean .

s223:hasSystemConnectionPoint a rdf:Property ;
    rdfs:label "hasSystemConnectionPoint" .

s223:hasTemperature a rdf:Property ;
    rdfs:label "hasTemperature" ;
    rdfs:subPropertyOf s223:hasProperty .

s223:inverseOf a rdf:Property ;
    rdfs:label "inverse of" .

s223:observes a rdf:Property ;
    rdfs:label "measures substance",
        "observes" ;
    rdfs:comment "The measuresSubstance relation is used to link to an Enumerable property that indicates what substance a sensor is measuring. It could be used, for example, to indicate that a sensor in an air stream is measuring carbon dioxide concentration.",
        "The relation observes binds a sensor to the ObservableProperty that represents the measured value." .

s223:servesZone a rdf:Property ;
    rdfs:label "serves Zone" .

s223:zoneConnected a s223:SymmetricProperty ;
    rdfs:label "Zone CP Connected" .



s223:Constant a s223:Class,
        sh:NodeShape ;
    rdfs:label "Constant" ;
    rdfs:comment "A constant is a parameter with constant value, used by the function block to produce one or more output (ex. pi)." ;
    rdfs:subClassOf s223:Concept,
        s223:Parameter ;
    sh:property [ rdfs:comment "An instance of Constant can be associated with any number of Property instances using the relation 'uses'." ;
            sh:class s223:Property ;
            sh:path s223:uses ] .

s223:FunctionInput a s223:Class,
        sh:NodeShape ;
    rdfs:label "Input" ;
    rdfs:comment "A Function Input is an input to a Function Block. It can be related to a property by s223:uses." ;
    rdfs:subClassOf s223:Concept ;
    sh:property [ rdfs:comment "An instance of Input must be associated with one Property instance using the relation 'uses'." ;
            sh:class s223:Property ;
            sh:maxCount 1 ;
            sh:message "This Function Input must be associated with exactly one property by s223:uses predicate." ;
            sh:minCount 1 ;
            sh:path s223:uses ],
        [ sh:class s223:FunctionBlock ;
            sh:maxCount 1 ;
            sh:message "This Input must be associated with exactly one FunctionBlock." ;
            sh:minCount 1 ;
            sh:path [ sh:inversePath s223:hasInput ] ] .

s223:FunctionOutput a s223:Class,
        sh:NodeShape ;
    rdfs:label "Output" ;
    rdfs:comment "A Function Output is an output from a Function Block and represents the action the function block has on the value of a property. It is related to a property by s223:produces." ;
    rdfs:subClassOf s223:Concept ;
    sh:property [ sh:class s223:FunctionBlock ;
            sh:maxCount 1 ;
            sh:message "This Output must be associated with exactly one FunctionBlock." ;
            sh:minCount 1 ;
            sh:path [ sh:inversePath s223:hasOutput ] ],
        [ rdfs:comment "An instance of Output must be associated with any number of Property instances using the relation 'produces'." ;
            sh:class s223:Property ;
            sh:minCount 1 ;
            sh:path s223:produces ] .

s223:HeatExchanger a s223:Class,
        sh:NodeShape ;
    rdfs:label "Heat exchanger" ;
    rdfs:subClassOf s223:Equipment ;
    sh:property [ rdfs:comment "A HeatExchanger can only have HeatExchanger roles" ;
            sh:class s223:Role-HeatExchanger ;
            sh:path s223:hasRole ] .

s223:InletConnectionPoint a s223:Class,
        sh:NodeShape ;
    rdfs:label "Inlet Connection Point" ;
    rdfs:comment "An InletConnectionPoint indicates that a substance must flow into the equipment or domain space at this connection point and cannot flow the other direction. An IntletConnectionPoint is a subclass of ConnectionPoint." ;
    rdfs:subClassOf s223:ConnectionPoint ;
    sh:property [ rdfs:comment "An InletConnectionPoint can ne associated with one other InletConnectionPoint using the relation mapsTo" ;
            sh:class s223:InletConnectionPoint ;
            sh:path s223:mapsTo ],
        [ rdfs:comment "Ensure an InletCP does not mapsTo a subordinate InletCP that is part of an internal Connection" ;
            sh:path s223:mapsTo ;
            sh:sparql [ a sh:SPARQLConstraint ;
                    rdfs:comment "Ensure a CP does not mapsTo a subordinate CP that is part of an internal Connection" ;
                    sh:message "{$this} should not have a mapsTo {?otherCP} because {?otherCP} participates in an internal Connection from {?destinationDevice}." ;
                    sh:prefixes <http://data.ashrae.org/standard223/1.0/validation/model> ;
                    sh:select """
SELECT $this ?otherCP ?destinationDevice
WHERE {
$this s223:mapsTo ?otherCP .
?equipment s223:hasConnectionPoint $this .
?otherEquipment s223:hasConnectionPoint ?otherCP .
?otherCP s223:connectsThrough/s223:connectsFrom ?destinationDevice .
?destinationDevice s223:contains ?equipment .
}
""" ] ] .

s223:Junction a s223:Class,
        sh:NodeShape ;
    rdfs:label "Junction" ;
    rdfs:comment "A Junction is used to join two or more Segments together. This might be where a duct splits or joins." ;
    rdfs:subClassOf s223:Concept ;
    sh:property [ rdfs:comment "A Junction should be associated with at least two Segments using the relation lnx" ;
            sh:class s223:Segment ;
            sh:message "Junction is missing one or more Segments" ;
            sh:minCount 2 ;
            sh:path s223:lnx ;
            sh:severity sh:Info ] .

s223:OutletConnectionPoint a s223:Class,
        sh:NodeShape ;
    rdfs:label "Outlet Connection Point" ;
    rdfs:comment "An OutletConnectionPoint indicates that a substance must flow out of the  or domain space at this connection point and cannot flow the other direction. An OutletConnectionPoint is a predefined subclass of ConnectionPoint." ;
    rdfs:subClassOf s223:ConnectionPoint ;
    sh:property [ rdfs:comment "An OutletConnectionPoint can be associated with one other OutletConnectionPoint using the relation mapsTo" ;
            sh:class s223:OutletConnectionPoint ;
            sh:path s223:mapsTo ],
        [ rdfs:comment "Ensure an OutletCP does not mapsTo a subordinate OutletCP that is part of an internal Connection" ;
            sh:path s223:mapsTo ;
            sh:sparql [ a sh:SPARQLConstraint ;
                    rdfs:comment "Ensure a CP does not mapsTo a subordinate CP that is part of an internal Connection" ;
                    sh:message "{$this} should not have a mapsTo {?otherCP} because {?otherCP} participates in an internal Connection to {?destinationDevice}." ;
                    sh:prefixes <http://data.ashrae.org/standard223/1.0/validation/model> ;
                    sh:select """
SELECT $this ?otherCP ?destinationDevice
WHERE {
$this s223:mapsTo ?otherCP .
?equipment s223:hasConnectionPoint $this .
?otherEquipment s223:hasConnectionPoint ?otherCP .
?otherCP s223:connectsThrough/s223:connectsTo ?destinationDevice .
?destinationDevice s223:contains ?equipment .
}
""" ] ] .

s223:Setpoint a s223:Class,
        sh:NodeShape ;
    rdfs:label "Setpoint" ;
    rdfs:subClassOf s223:Property,
        qudt:Quantity ;
    sh:property [ rdfs:comment "A Setpoint can be associated with a decimal value using the relation hasDeadband" ;
            sh:datatype xsd:decimal ;
            sh:path s223:hasDeadband ],
        [ rdfs:comment "A Setpoint can be assicated with a decimal value using the relation hasValue" ;
            sh:datatype xsd:decimal ;
            sh:path s223:hasValue ] ;
    sh:rule [ a sh:SPARQLRule ;
            rdfs:comment "Infer the hasQuantityKind relationship for a Setpoint if it is unambiguous" ;
            sh:construct """
CONSTRUCT {$this qudt:hasQuantityKind ?qk .}
WHERE {
FILTER (NOT EXISTS {$this qudt:hasQuantityKind ?something}) .
$this ^s223:hasSetpoint ?property .
?property qudt:hasQuantityKind ?qk .
}
""" ;
            sh:prefixes <http://data.ashrae.org/standard223/1.0/inference/model-rules> ] .

s223:System a s223:Class,
        sh:NodeShape ;
    rdfs:label "System" ;
    rdfs:comment "A System is a logical grouping (collection) of Equipment for some functional or system reason, such as a chilled water system, or HVAC system. A System does not participate in Connections." ;
    rdfs:subClassOf s223:Concept ;
    sh:property [ a sh:PropertyShape ;
            rdfs:comment "A System can be associated with zero or any number of other instances of Equipment or System using the relation hasMember" ;
            sh:minCount 0 ;
            sh:or ( [ sh:class s223:Equipment ] [ sh:class s223:System ] ) ;
            sh:path s223:hasMember ],
        [ rdfs:comment "A System can be associated with any number of EnumerationKind-Roles using the relation hasRole" ;
            sh:class s223:EnumerationKind-Role ;
            sh:path s223:hasRole ],
        s223:hasPropertyShape .

s223:actuates a rdf:Property ;
    rdfs:label "actuates" ;
    rdfs:comment "The relation actuates binds an Actuator to the Equipment that it actuates. The Equipment will have the ActuatableProperty that commands the actuator (see `s223:commandedByProperty`)." .

s223:connectsFrom a rdf:Property ;
    rdfs:label "connects from" ;
    rdfs:comment "The relation connectsFrom binds a Connectable thing to a Connection with an implied directionality. B connectsFrom A indicates a flow from A to B." .

s223:connectsTo a rdf:Property ;
    rdfs:label "connects to" ;
    rdfs:comment "The connectsTo relation binds a specific ConnectionPoint to a Connection, See Figure x.y. The relation connectsTo binds a Connectable thing to a Connection with an implied directionality. A connectsTo B indicates a flow from A to B." .

s223:executes a rdf:Property ;
    rdfs:label "executes" ;
    rdfs:comment "The relation executes is used to specify that a controller (see `s223:Controller`) is responsible of the execution of a function block (see `s223:FunctionBlock`). " .

s223:hasAspect a rdf:Property ;
    rdfs:label "has aspect" ;
    rdfs:comment "hasAspect is used to establish the context of a Property. The value must be an instance of EnumerationKind. For example, if a Property has a Temperature value of 45.3, the hasAspect relation is used to state what that represents, such as a Temperature limit during working hours, etc. A Property can have any number of hasAspect relations, as needed to establish the context." .

s223:hasConstant a rdf:Property ;
    rdfs:label "has constant" ;
    rdfs:comment "The relation hasConstant is used to relate a constant (see `s223:Constant`) to a function block (see `s223:FunctionBlock`)." .

s223:hasDeadband a rdf:Property ;
    rdfs:label "has deadband" .

s223:hasMeasurementLocationLow a rdf:Property ;
    rdfs:label "has measurement location low" ;
    rdfs:comment "The relation hasMeasurementLocationLow associates a differential sensor to one of the topological locations where a differential property is measured." ;
    rdfs:subPropertyOf s223:hasMeasurementLocation .

s223:hasMeasurementResolution a rdf:Property ;
    rdfs:label "has measurement resolution" ;
    rdfs:comment "The hasMeasurementResolution relation is used to link to a numerical property whose value indicates the smallest recognizable change in engineering units that the sensor can indicate. " .

s223:hasMember a rdf:Property ;
    rdfs:label "has member" .

s223:hasPhysicalLocation a rdf:Property ;
    rdfs:label "has Physical Location" ;
    rdfs:comment "The relation hasPhysicalLocation is used to indicate the physical space (see `s223:PhysicalSpace`) where an equipment (see `s223:Equipment`) is located." .

s223:hasSetpoint a rdf:Property ;
    rdfs:label "has setpoint" ;
    rdfs:comment "This relation binds a control setpoint to the quantifiable property indicating the desired value which the control process is trying to maintain." .

s223:ofMedium a rdf:Property ;
    rdfs:label "of medium" .

s223:ofSubstance a rdf:Property ;
    rdfs:label "of substance" .

s223:produces a rdf:Property ;
    rdfs:label "produces" ;
    rdfs:comment "The relation produces is used to relate a function output (see `s223:FunctionOutput`) to a property (see `s223:Property`). This allows to specify that the value of this property is produced by the function block output. Allowing the users of the model to understand that the value of the property is the result of the algorithm defined by the function block. " .

rdfs:comment a rdf:Property ;
    rdfs:label "Description of constraints for s223" ;
    rdfs:subPropertyOf rdfs:comment .

s223:AbstractSensor a s223:Class,
        sh:NodeShape ;
    rdfs:label "Abstract sensor" ;
    s223:abstract true ;
    rdfs:comment "This is an abstract class that represents properties that are common to all sensor types." ;
    rdfs:subClassOf s223:Equipment ;
    sh:property [ rdfs:comment "A Sensor can be associated with a QuantifiableProperty by hasMeasurementResolution" ;
            sh:class s223:QuantifiableProperty ;
            sh:path s223:hasMeasurementResolution ],
        [ rdfs:comment "A Sensor can be associated with at most 1 ObservableProperty by observesProperty" ;
            sh:class s223:ObservableProperty ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path s223:observesProperty ],
        [ sh:name "Test for compatible declared Substances" ;
            sh:path s223:measuresSubstance ;
            sh:sparql [ a sh:SPARQLConstraint ;
                    rdfs:comment "Ensure that the Substance identified by a sensor via the s223:measuresSubstance relation is compatible with the Substance identified by the Property being measured via the s223:ofSubstance relation." ;
                    sh:message "Sensor {$this} measures substance {?a}, but the measured Property identifies an incompatible substance of {?b} via the s223:ofSubstance relation." ;
                    sh:prefixes <http://data.ashrae.org/standard223/1.0/validation/model> ;
                    sh:select """
SELECT DISTINCT $this ?a ?b
WHERE {
$this s223:measuresSubstance ?a .
$this s223:observesProperty/s223:ofSubstance ?b .
?a a/rdfs:subClassOf* s223:EnumerationKind .
?b a/rdfs:subClassOf* s223:EnumerationKind .
FILTER (?a != ?b ) .
FILTER (NOT EXISTS {?b a/rdfs:subClassOf* ?a}) .
FILTER (NOT EXISTS {?a a/rdfs:subClassOf* ?b}) .
}
""" ] ] .

s223:Coil a s223:Class,
        sh:NodeShape ;
    rdfs:label "Coil" ;
    rdfs:subClassOf s223:HeatExchanger .

s223:Damper a s223:Class,
        sh:NodeShape ;
    rdfs:label "Damper" ;
    rdfs:subClassOf s223:Equipment ;
    sh:property [ a sh:PropertyShape ;
            rdfs:comment "A Damper must be associated with at least two ConnectionPoints by hasConnectionPoint" ;
            sh:class s223:ConnectionPoint ;
            sh:minCount 2 ;
            sh:name "Air inlet point" ;
            sh:path s223:hasConnectionPoint ] .

s223:EnumerableProperty a s223:Class,
        sh:NodeShape ;
    rdfs:label "Enumerable Property" ;
    rdfs:subClassOf s223:Property ;
    sh:property [ rdfs:comment "An EnumerableProperty must be associated with one EnumerationKind using the relation hasEnumerationKind" ;
            sh:class s223:EnumerationKind ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path s223:hasEnumerationKind ],
        [ rdfs:comment "Checks for valid enumeration value" ;
            sh:path s223:hasValue ;
            sh:sparql [ a sh:SPARQLConstraint ;
                    sh:message "{$this} has an enumeration value of {?value} which is not a valid {?kind}." ;
                    sh:prefixes <http://data.ashrae.org/standard223/1.0/validation/model> ;
                    sh:select """
SELECT $this ?value ?kind
WHERE {
$this s223:hasValue ?value .
$this s223:hasEnumerationKind ?kind .
FILTER (NOT EXISTS {?value a/rdfs:subClassOf* ?kind}) .
}
""" ] ] .

s223:EnumerationKind-Effectiveness a s223:Class,
        s223:EnumerationKind-Effectiveness,
        sh:NodeShape ;
    rdfs:label "Effectiveness" ;
    rdfs:subClassOf s223:EnumerationKind .

s223:FlowEquipment a s223:Class,
        sh:NodeShape ;
    rdfs:label "Flow Equipment" ;
    rdfs:subClassOf s223:Equipment ;
    sh:property [ a sh:PropertyShape ;
            rdfs:comment "An instance of Flow Equipment must be associated with any number of ConnectionPoint instances using the relation 'has connection point'." ;
            sh:class s223:ConnectionPoint ;
            sh:minCount 2 ;
            sh:name "Inlet or Outlet point property" ;
            sh:path s223:hasConnectionPoint ;
            sh:severity sh:Info ] .

s223:ManualValve a s223:Class,
        sh:NodeShape ;
    rdfs:label "Manual Valve" ;
    rdfs:subClassOf s223:Valve .

s223:MotorizedValve a s223:Class,
        sh:NodeShape ;
    rdfs:label "Motorized Valve" ;
    rdfs:subClassOf s223:Valve .

s223:Parameter a s223:Class,
        sh:NodeShape ;
    rdfs:label "Parameter" ;
    rdfs:comment "A parameter belongs to exactly one Function Block." ;
    rdfs:subClassOf s223:Concept ;
    sh:property [ rdfs:comment "An instance of Parameter can be associated with any number of Property instances using the relation 'uses'." ;
            sh:class s223:Property ;
            sh:path s223:uses ],
        [ sh:class s223:FunctionBlock ;
            sh:maxCount 1 ;
            sh:message "This Parameter must be associated with exactly one FunctionBlock." ;
            sh:minCount 1 ;
            sh:path [ sh:inversePath s223:hasParameter ] ] .

s223:PhysicalSpace a s223:Class,
        sh:NodeShape ;
    rdfs:label "Physical Space" ;
    rdfs:comment "A PhysicalSpace is an architectural concept that can represent a room, a collection of rooms such as a floor, a part of a room, or any physical space that might not even be thought of as a room, such as a patio space or a roof." ;
    rdfs:subClassOf s223:Concept ;
    sh:property [ rdfs:comment "A PhysicalSpace can be associated with any number of other PhysicalSpaces using the relation contains" ;
            sh:class s223:PhysicalSpace ;
            sh:path s223:contains ],
        [ rdfs:comment "A PhysicalSpace can be associated with any number of DomainSpaces using the relation encloses" ;
            sh:class s223:DomainSpace ;
            sh:path s223:encloses ],
        [ rdfs:comment "PhysicalSpaces must be associated by s223:hasDomain to Domain-Physical [Is this in the standard?]" ;
            sh:class s223:EnumerationKind-Domain ;
            sh:path s223:hasDomain ] .

s223:Valve a s223:Class,
        sh:NodeShape ;
    rdfs:label "Valve" ;
    rdfs:subClassOf s223:Equipment .

s223:Zone a s223:Class,
        sh:NodeShape ;
    rdfs:label "Zone" ;
    rdfs:comment "A Zone is a logical grouping (collection) of domain spaces for some functional or system reason, to identify a domain of control, such as a Lighting Zone, or a heating zone" ;
    rdfs:subClassOf s223:Concept ;
    sh:property [ rdfs:comment "A Zone can be associated with any number of other DomainSpaces or Zones using the relation contains" ;
            sh:or ( [ sh:class s223:DomainSpace ] [ sh:class s223:Zone ] ) ;
            sh:path s223:contains ],
        [ rdfs:comment "A Zone must be associated with one EnumerationKind-Domain using the relation hasDomain" ;
            sh:class s223:EnumerationKind-Domain ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path s223:hasDomain ],
        s223:hasPropertyShape ;
    sh:rule [ a sh:TripleRule ;
            rdfs:comment "Traverse down the contains hierarchy to determine the domain" ;
            sh:object [ sh:path ( [ sh:zeroOrMorePath s223:contains ] s223:hasDomain ) ] ;
            sh:predicate s223:hasDomain ;
            sh:subject sh:this ] .

s223:commandedByProperty a rdf:Property ;
    rdfs:label "commanded by Property" ;
    rdfs:comment "The relation commandedByProperty binds an Actuator to the ActuatableProperty that it responds to. This Property will be owned by the equipment that it actuates (see `s223:actuates`)." .

s223:connectedThrough a rdf:Property ;
    rdfs:label "connected through" .

s223:encloses a rdf:Property ;
    rdfs:label "encloses" ;
    rdfs:comment "The relation encloses is used to indicate that a domain space (see: `s223:DomainSpace`) can be found inside a physical space (see `s223:PhysicalSpace`). " .

s223:hasEnumerationKind a rdf:Property ;
    rdfs:label "has enumeration kind" ;
    rdfs:comment "The relation hasEnumerationKind associates an EnumerableProperty with a class of enumeration values. This is used to, for example, identify what kind of substance is transported along a Connection or which day of the week a setpoint is active" .

s223:hasInput a rdf:Property ;
    rdfs:label "has function input" ;
    rdfs:comment "The relation hasInput is used to relate a function input (see `s223:FunctionInput`) to a function block (see `s223:FunctionBlock`). " .

s223:hasMeasurementLocationHigh a rdf:Property ;
    rdfs:comment "The relation hasMeasurementLocationHigh associates a differential sensor to one of the topological locations where a differential property is measured." ;
    rdfs:subPropertyOf s223:hasMeasurementLocation .

s223:hasOutput a rdf:Property ;
    rdfs:label "has function output" ;
    rdfs:comment "The relation hasOutput is used to relate a function output (see `s223:FunctionOutput`) to a function block (see `s223:FunctionBlock`). " .

s223:hasParameter a rdf:Property ;
    rdfs:label "has parameter" ;
    rdfs:comment "A Parameter (`s223:Parameter`) is associated to a function block (`s223:FunctionBlock`) using the relation hasParameter. " .

s223:measuresSubstance a rdf:Property ;
    rdfs:label "measures Substance" ;
    rdfs:comment "The relation measuresSubstance is used to relate a sensor (see `s223:Sensor`) to a substance (see `s223:Substance`). Some sensors measure a specific property inside a medium and this substance can be defined by relating the sensor to it using the relation hasSubstance (ex. Substance-CO2 in Medium-Air). " .

s223:DayOfWeek-Weekend a s223:Class,
        s223:DayOfWeek-Weekend,
        sh:NodeShape ;
    rdfs:label "Day of week-Weekend",
        "Weekend" ;
    rdfs:comment "This class defines the EnumerationKind values of Saturday and Sunday" ;
    rdfs:subClassOf s223:EnumerationKind-DayOfWeek .

s223:DomainSpace a s223:Class,
        sh:NodeShape ;
    rdfs:label "Domain Space" ;
    rdfs:comment "A DomainSpace is a member (or component) of a Zone and is associated with a Domain such as Lighting, HVAC, PhysicalSecurity, etc. Physical spaces enclose Domain spaces." ;
    rdfs:subClassOf s223:Connectable ;
    sh:property [ rdfs:comment "A DomainSpace must be associated with one EnumerationKind-Domain using the relation hasDomain" ;
            sh:class s223:EnumerationKind-Domain ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:path s223:hasDomain ],
        [ rdfs:comment "This DomainSpace must eventually be enclosed by a PhysicalSpace." ;
            sh:message "This DomainSpace must eventually be enclosed by a PhysicalSpace." ;
            sh:minCount 1 ;
            sh:path [ sh:inversePath s223:encloses ] ;
            sh:severity sh:Info ],
        s223:hasPropertyShape .

s223:EnumerationKind-DayOfWeek a s223:Class,
        s223:EnumerationKind-DayOfWeek,
        sh:NodeShape ;
    rdfs:label "Day of Week" ;
    rdfs:comment "This class has enumerated instances of Monday, Tuesday, Wednesday, Thursday, Friday, Saturday and Sunday. The Weekend and Weekday EnumerationKinds define subsets of this EnumerationKind for Mon-Fri and Sat,Sun respectively" ;
    rdfs:subClassOf s223:EnumerationKind .

s223:LightSensor a s223:Class,
        sh:NodeShape ;
    rdfs:label "Light sensor" ;
    rdfs:comment "A LightSensor is a specialization of a Sensor that observes a QuantifiableObservableProperty that represents a luminance measurement." ;
    rdfs:subClassOf s223:Sensor .

s223:Medium-Light a s223:Class,
        s223:Medium-Light,
        sh:NodeShape ;
    rdfs:label "Medium-Light" ;
    rdfs:subClassOf s223:EnumerationKind-Medium .

s223:Medium-Water a s223:Class,
        s223:Medium-Water,
        sh:NodeShape ;
    rdfs:label "Medium-Water" ;
    rdfs:subClassOf s223:EnumerationKind-Medium .

s223:ObservableProperty a s223:Class,
        sh:NodeShape ;
    rdfs:label "Observable Property" ;
    rdfs:comment "This class describes non-numeric properties of which real-time value cannot be modified by a user or a machine outside of the model. Sensors reading are typically observable properties as their value naturally fluctuate, but is not meant to be modified by a user." ;
    rdfs:subClassOf s223:Property .

s223:Occupancy-Motion a s223:Class,
        s223:Occupancy-Motion,
        sh:NodeShape ;
    rdfs:label "Occupancy Motion" ;
    rdfs:subClassOf s223:EnumerationKind-Occupancy .

s223:Occupancy-Presence a s223:Class,
        s223:Occupancy-Presence,
        sh:NodeShape ;
    rdfs:label "Occupancy Presence" ;
    rdfs:subClassOf s223:EnumerationKind-Occupancy .

s223:OccupancySensor a s223:Class,
        sh:NodeShape ;
    rdfs:label "Occupancy sensor" ;
    rdfs:comment "An OccuppancySensor is a specialization of a Sensor that observes a Property that represents measurement of occupancy in a space." ;
    rdfs:subClassOf s223:Sensor .

s223:QuantifiableProperty a s223:Class,
        sh:NodeShape ;
    rdfs:label "Quantifiable Property" ;
    rdfs:comment "This class is for quantifiable values that describe an object (System, Equipment, etc.) that are typically static (hasValue). That is, they are neither measured nor specified in the course of operations." ;
    rdfs:subClassOf s223:Property,
        qudt:Quantity ;
    sh:property [ rdfs:comment "A QuantifiableProperty can be associated with any number of Setpoints using the relation hasSetpoint" ;
            sh:class s223:Setpoint ;
            sh:path s223:hasSetpoint ],
        [ rdfs:comment "A QuantifiableProperty can be associated with a decimal value using the relation hasValue" ;
            sh:datatype xsd:decimal ;
            sh:path s223:hasValue ],
        [ rdfs:comment "A QuantifiableProperty must be associated with at least one quantitykind using the relation hasQuantityKind." ;
            sh:minCount 1 ;
            sh:path qudt:hasQuantityKind ],
        [ rdfs:comment "A QuantifiableProperty should be associated with at least one unit using the relation unit." ;
            sh:minCount 1 ;
            sh:path qudt:unit ;
            sh:severity sh:Info ],
        [ rdfs:comment "This QuantifiableProperty and the Setpoint associated with it have non-commensurate QuantityKinds" ;
            sh:path qudt:hasQuantityKind ;
            sh:sparql [ a sh:SPARQLConstraint ;
                    sh:message "{$this} uses QuantityKind {?pqk} with DimensionVector {?pdv}, while Setpoint {?setpoint} uses QuantityKind {?sqk} with DimensionVector {?sdv}. These are non-commensurate" ;
                    sh:prefixes <http://data.ashrae.org/standard223/1.0/validation/model> ;
                    sh:select """
SELECT $this ?setpoint ?pqk ?sqk ?pdv ?sdv
WHERE {
$this qudt:hasQuantityKind ?pqk .
$this s223:hasSetpoint ?setpoint .
?setpoint qudt:hasQuantityKind ?sqk .
?pqk qudt:hasDimensionVector ?pdv .
?sqk qudt:hasDimensionVector ?sdv .
FILTER (?pqk != ?sqk) .
FILTER (?pdv != ?sdv) .
}
""" ] ],
        [ rdfs:comment "This QuantifiableProperty and the associated Setpoint use non-commensurate Units" ;
            sh:path qudt:unit ;
            sh:sparql [ a sh:SPARQLConstraint ;
                    sh:message "{$this} uses Unit {?punit}, while Setpoint {?setpoint} uses Unit {?sunit}. These are non-commensurate." ;
                    sh:prefixes <http://data.ashrae.org/standard223/1.0/validation/model> ;
                    sh:select """
SELECT $this ?setpoint ?punit ?sunit
WHERE {
$this qudt:unit ?punit .
$this s223:hasSetpoint ?setpoint .
?setpoint qudt:unit ?sunit .
?punit qudt:hasDimensionVector ?pdv .
?sunit qudt:hasDimensionVector ?sdv .
FILTER (?punit != ?sunit) .
FILTER (?pdv != ?sdv) .
}
""" ] ],
        [ rdfs:comment "This QuantifiableProperty uses a different Unit than the Setpoint associated with it" ;
            sh:path qudt:unit ;
            sh:severity sh:Info ;
            sh:sparql [ a sh:SPARQLConstraint ;
                    sh:message "{$this} uses Unit {?punit}, while Setpoint {?setpoint} uses Unit {?sunit}. Be careful." ;
                    sh:prefixes <http://data.ashrae.org/standard223/1.0/validation/model> ;
                    sh:select """
SELECT $this ?setpoint ?punit ?sunit
WHERE {
$this qudt:unit ?punit .
$this s223:hasSetpoint ?setpoint .
?setpoint qudt:unit ?sunit .
?punit qudt:hasDimensionVector ?pdv .
?sunit qudt:hasDimensionVector ?sdv .
FILTER (?punit != ?sunit) .
FILTER (?pdv = ?sdv) .
}
""" ] ] ;
    sh:rule [ a sh:SPARQLRule ;
            rdfs:comment "Infer the hasQuantityKind relationship if it is unambiguous" ;
            sh:construct """
CONSTRUCT {
$this qudt:hasQuantityKind ?uniqueqk
}
WHERE {
{
SELECT $this (COUNT (DISTINCT (?qk)) AS ?count)
WHERE {
FILTER (NOT EXISTS {$this qudt:hasQuantityKind ?something}) .
$this qudt:unit/qudt:hasQuantityKind ?qk .
}
GROUP BY $this
}
FILTER (?count = 1)
$this qudt:unit/qudt:hasQuantityKind ?uniqueqk .
}
""" ;
            sh:prefixes <http://data.ashrae.org/standard223/1.0/inference/model-rules> ] ;
    sh:sparql [ a sh:SPARQLConstraint ;
            rdfs:comment "Checks for consistent dimension vectors for a QuantityKind and the Unit" ;
            sh:message "Inconsistent dimensionalities among the Property's Unit and Property's Quantity Kind" ;
            sh:prefixes <http://data.ashrae.org/standard223/1.0/validation/data> ;
            sh:select """
SELECT $this ?count
WHERE {  
{ SELECT  $this (COUNT (DISTINCT ?qkdv) AS ?count)
   WHERE 
{
      {
      $this qudt:hasQuantityKind/qudt:hasDimensionVector ?qkdv .
      }
      UNION
      {
      $this qudt:unit/qudt:hasDimensionVector ?qkdv .
      }
}
 GROUP BY $this 
}
FILTER (?count > 1) .
}
""" ] .

s223:connected a s223:SymmetricProperty,
        rdf:Property ;
    rdfs:label "connected" ;
    rdfs:comment "The relation connected indicates that two connectable things are connected without regard to any directionality of a process flow.  " .

s223:hasMedium a rdf:Property ;
    rdfs:label "has Medium" ;
    rdfs:comment "The relation hasMedium is used to indicate what medium is flowing through the connection (e.g., air, water, electricity). The possible values are defined in EnumerationKind-Medium (see `s223:EnumerationKind-Medium`)." .

s223:lnx a s223:SymmetricProperty ;
    rdfs:label "lnx" ;
    rdfs:comment "The lnx property is a symmetric property associating adjacent entities in a Segment-Junction Network." .

s223:uses a rdf:Property ;
    rdfs:label "uses" ;
    rdfs:comment "The relation uses is used to relate a function block input (see `s223:FunctionInput`) to a property (see `s223:Property`). This allows to specify that the value of this property is used by the function block. " .

qudt:unit rdfs:comment "A reference to the unit of measure of a QuantifiableProperty of interest." .

s223:ActuatableProperty a s223:Class,
        sh:NodeShape ;
    rdfs:label "Actuatable Property" ;
    rdfs:comment "This class describes non-numeric properties of which real-time value can be modified by a user or a machine outside of the model." ;
    rdfs:subClassOf s223:Property .

s223:EnumerationKind-Binary a s223:Class,
        s223:EnumerationKind-Binary,
        sh:NodeShape ;
    rdfs:label "EnumerationKind Binary" ;
    rdfs:comment "This class has enumerated instances of True, False and Unknown used to describe the possible values of a binary property" ;
    rdfs:subClassOf s223:EnumerationKind .

s223:EnumerationKind-Direction a s223:Class,
        s223:EnumerationKind-Direction,
        sh:NodeShape ;
    rdfs:label "Direction" ;
    rdfs:comment "This class has enumerated instances of Bidirectional, Inlet and Outlet used to qualify ConnectionPoints." ;
    rdfs:subClassOf s223:EnumerationKind .

s223:EnumerationKind-OnOff a s223:Class,
        s223:EnumerationKind-OnOff,
        sh:NodeShape ;
    rdfs:label "OnOff enumeration" ;
    rdfs:subClassOf s223:EnumerationKind .

s223:EnumerationKind-PositionStatus a s223:Class,
        s223:EnumerationKind-PositionStatus,
        sh:NodeShape ;
    rdfs:label "Position status" ;
    rdfs:subClassOf s223:EnumerationKind .

s223:EnumerationKind-RunStatus a s223:Class,
        s223:EnumerationKind-RunStatus,
        sh:NodeShape ;
    rdfs:label "Run status" ;
    rdfs:subClassOf s223:EnumerationKind .

s223:FunctionBlock a s223:Class,
        sh:NodeShape ;
    rdfs:label "Function block" ;
    rdfs:comment "A FunctionBlock is used to model transfer and/or transformation of information (i.e. Property). It has relations to input properties and output properties. The actual algorithms that perform the transformations are described in CDL and are out of scope of the 223 standard." ;
    rdfs:subClassOf s223:Concept ;
    sh:property [ rdfs:comment "An instance of Function block can be associated with any number of Constant instances using the relation 'has constant'." ;
            sh:class s223:Constant ;
            sh:path s223:hasConstant ],
        [ rdfs:comment "An instance of Function block can be associated with any number of Input instances using the relation 'has function input'." ;
            sh:class s223:FunctionInput ;
            sh:path s223:hasInput ],
        [ rdfs:comment "An instance of Function block can be associated with any number of Output instances using the relation 'has function output'." ;
            sh:class s223:FunctionOutput ;
            sh:path s223:hasOutput ],
        [ rdfs:comment "An instance of Function block can be associated with any number of Parameter instances using the relation 'has parameter'." ;
            sh:class s223:Parameter ;
            sh:path s223:hasParameter ] .

s223:Role-HeatExchanger a s223:Class,
        s223:Role-HeatExchanger,
        sh:NodeShape ;
    rdfs:label "Role-HeatExchanger" ;
    rdfs:subClassOf s223:EnumerationKind-Role .

s223:SymmetricProperty a s223:Class,
        sh:NodeShape ;
    rdfs:label "Symmetric property" ;
    rdfs:comment "Symmetric properties used to associate adjacent entities. See s223:cnx, s223:connected, s223:lnx" ;
    rdfs:subClassOf rdf:Property .

s223:connectedFrom a rdf:Property ;
    rdfs:label "connected from" ;
    s223:inverseOf s223:connectedTo ;
    rdfs:comment "The relation connectedFrom indicates that connectable things are connected with a specific direction of flow. B is connectedFrom A indicates a directionality beginning at A and ending at B.  The inverse direction is indicated by connectedTo (see `s223:connectedTo`)." ;
    rdfs:domain s223:Equipment .

s223:connectedTo a rdf:Property ;
    rdfs:label "connected to" ;
    s223:inverseOf s223:connectedFrom ;
    rdfs:comment "The relation connectedTo indicates that connectable things are connected with a specific direction of flow. A is connectedTo B indicates a directionality beginning at A and ending at B.  The inverse direction is indicated by connectedFrom (see `s223:connectedFrom`)." ;
    rdfs:domain s223:Equipment .

s223:connectsAt a rdf:Property ;
    rdfs:label "connects at" ;
    s223:inverseOf s223:connectsThrough ;
    rdfs:comment "The connectsAt relation binds a Connection to a specific ConnectionPoint. See Figure x.y." .

s223:connectsThrough a rdf:Property ;
    rdfs:label "connects through" ;
    s223:inverseOf s223:connectsAt ;
    rdfs:comment "The relation connectedThrough binds a Connectable thing to a Connection without regard to the direction of flow. It is used to discover what connection links two connectable things." .

s223:hasMeasurementLocation a rdf:Property ;
    rdfs:label "has measurement location" ;
    rdfs:comment "The relation hasMeasurementLocation associates a sensor to the topological location where it is measuring. The measurement location can be a ConnectionPoint, Connection, Segment or a DomainSpace." .

s223:hasProperty a rdf:Property ;
    rdfs:label "has Property" .

s223:hasRole a rdf:Property ;
    rdfs:comment "The relation hasRole is used to indicate the role of an Equipment, Connection, or System within a building (e.g. a heating coil will be associated to Role-Heating). Possible values are defined in EnumerationKind-Role (see `s223:EnumerationKind-Role`)." .

s223:hasValue a rdf:Property ;
    rdfs:label "hasValue" ;
    rdfs:comment "hasValue is used to contain a fixed value that is part of a 223 model, rather than a computed, measured, or externally derived variable." .

qudt:hasQuantityKind rdfs:comment "A reference to the QuantityKind of a QuantifiableProperty of interest, e.g. quantitykind:Temperature." .

s223:EnumerationKind-ThreeSpeedSetting a s223:Class,
        s223:EnumerationKind-ThreeSpeedSetting,
        sh:NodeShape ;
    rdfs:label "Three speed setting" ;
    rdfs:subClassOf s223:EnumerationKind .

s223:Segment a s223:Class,
        sh:NodeShape ;
    rdfs:label "Segment" ;
    rdfs:comment "When necessary, a Connection may be subdivided into a network of Segments, joined at Junctions. This can be useful for identifying a segment of a duct before a split, for example." ;
    rdfs:subClassOf s223:Concept ;
    sh:property [ rdfs:comment "A Segment must be associated with two Junctions or ConnectionPoints using the relation lnx" ;
            sh:maxCount 2 ;
            sh:message "Segment is missing one or both endpoints (Junction or ConnectionPoint)" ;
            sh:minCount 2 ;
            sh:or ( [ sh:class s223:Junction ] [ sh:class s223:ConnectionPoint ] ) ;
            sh:path s223:lnx ;
            sh:qualifiedMaxCount 1 ;
            sh:qualifiedValueShape [ sh:class s223:ConnectionPoint ] ;
            sh:severity sh:Warning ] .

s223:Substance-Particulate a s223:Class,
        s223:Substance-Particulate,
        sh:NodeShape ;
    rdfs:label "Particulate" ;
    rdfs:subClassOf s223:EnumerationKind-Substance .

s223:contains a rdf:Property ;
    rdfs:label "contains" .

s223:isConnectionPointOf a rdf:Property ;
    rdfs:label "is connection point of" ;
    s223:inverseOf s223:hasConnectionPoint ;
    rdfs:comment "The relation isConnectionPointOf is part of a pair of relations that bind a ConnectionPoint to a Connectable thing. It is the inverse of the relation hasConnectionPoint (see `s223:hasConnectionPoint`)." .

s223:Connection a s223:Class,
        sh:NodeShape ;
    rdfs:label "Connection" ;
    rdfs:comment """A Connection is the modeling construct used to represent a physical thing (e.g., pipe, duct, or wire) that is used to convey some Medium (e.g., water, air, or electricity) between two connectable things. All Connections have two or more ConnectionPoints that are bound to either Equipment (see `s223:Equipment`) or DomainSpace (see `s223:DomainSpace`). If the direction of flow is constrained, that constraint is indicated by using one or more InletConnectionPoints (see `s223:InletConnectionPoint`) to represent the inflow points and OutletConnectionPoints (see `s223:OutletConnectionPoint`) to represent the outflow points.
  
A Connection may contain branches or intersections. These are modeled using Segments (see `s223:Segment`) and Junctions (see `s223:Junction`).
""" ;
    rdfs:subClassOf s223:Concept ;
    sh:property [ rdfs:comment "A Connection can be associated with any number of ConnectionPoints using the relation connectsAt" ;
            sh:class s223:ConnectionPoint ;
            sh:path s223:connectsAt ],
        [ rdfs:comment "A Connection can be associated with any number of Connectables using the relation connectsFrom" ;
            sh:class s223:Connectable ;
            sh:name "ConnectionToUpstreamConnectableShape" ;
            sh:path s223:connectsFrom ],
        [ rdfs:comment "A Connection can be associated with any number of Connectables using the relation connectsTo" ;
            sh:class s223:Connectable ;
            sh:name "ConnectionToDownstreamConnectableShape" ;
            sh:path s223:connectsTo ],
        [ rdfs:comment "A Connection must be associated with one EnumerationKind-Medium using the relation hasMedium" ;
            sh:class s223:EnumerationKind-Medium ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:name "Connection medium" ;
            sh:path s223:hasMedium ],
        [ sh:class s223:EnumerationKind-Phase ;
            sh:path s223:hasPhase ],
        [ rdfs:comment "A Connection can be associated with an EnumerationKind-Role using the relation hasRole" ;
            sh:class s223:EnumerationKind-Role ;
            sh:path s223:hasRole ],
        s223:hasPropertyShape ;
    sh:rule [ a sh:SPARQLRule ;
            rdfs:comment "Infer the connectsFrom relationship" ;
            sh:construct """
CONSTRUCT {$this s223:connectsFrom ?equipment .}
WHERE {
$this s223:connectsAt ?cp .
?cp a s223:OutletConnectionPoint .
?cp s223:isConnectionPointOf ?equipment .
}
""" ;
            sh:name "InferredConnectionToUpstreamEquipmentProperty" ;
            sh:prefixes <http://data.ashrae.org/standard223/1.0/inference/model-rules> ],
        [ a sh:SPARQLRule ;
            rdfs:comment "Infer the connectsTo relationship" ;
            sh:construct """
CONSTRUCT {$this s223:connectsTo ?equipment .}
WHERE {
$this s223:connectsAt ?cp .
?cp a s223:InletConnectionPoint .
?cp s223:isConnectionPointOf ?equipment .
}
""" ;
            sh:name "InferredConnectionToDownstreamEquipmentProperty" ;
            sh:prefixes <http://data.ashrae.org/standard223/1.0/inference/model-rules> ],
        [ a sh:TripleRule ;
            rdfs:comment "Infer cnx relationship from connectsAt",
                "InferredConnectionToConnectionPointBaseProperty" ;
            sh:object [ sh:path s223:connectsAt ] ;
            sh:predicate s223:cnx ;
            sh:subject sh:this ],
        [ a sh:TripleRule ;
            rdfs:comment "Infer cnx relationship from connectsThrough",
                "InferredConnectionToConnectionPointBasePropertyFromInverse" ;
            sh:object [ sh:path [ sh:inversePath s223:connectsThrough ] ] ;
            sh:predicate s223:cnx ;
            sh:subject sh:this ],
        [ a sh:TripleRule ;
            rdfs:comment "Infer the connectsAt relationship from cnx",
                "InferredConnectionToConnectionPointProperty" ;
            sh:object [ sh:path s223:cnx ] ;
            sh:predicate s223:connectsAt ;
            sh:subject sh:this ] .

s223:DayOfWeek-Weekday a s223:Class,
        s223:DayOfWeek-Weekday,
        sh:NodeShape ;
    rdfs:label "Day of week-Weekday",
        "Weekday" ;
    rdfs:comment "This class defines the EnumerationKind values of Monday, Tuesday, Wednesday, Thursday and Friday" ;
    rdfs:subClassOf s223:EnumerationKind-DayOfWeek .

s223:EnumerationKind-HVACOperatingMode a s223:Class,
        s223:EnumerationKind-HVACOperatingMode,
        sh:NodeShape ;
    rdfs:label "HVAC system/equipment operating mode. The policy under which the system is operating." ;
    rdfs:subClassOf s223:EnumerationKind .

s223:EnumerationKind-HVACOperatingStatus a s223:Class,
        s223:EnumerationKind-HVACOperatingStatus,
        sh:NodeShape ;
    rdfs:label "HVAC system/equipment operating status. What the system is currently doing." ;
    rdfs:subClassOf s223:EnumerationKind .

s223:EnumerationKind-Occupancy a s223:Class,
        s223:EnumerationKind-Occupancy,
        sh:NodeShape ;
    rdfs:label "Occupancy status" ;
    rdfs:subClassOf s223:EnumerationKind .

s223:EnumerationKind-Substance a s223:Class,
        s223:EnumerationKind-Substance,
        sh:NodeShape ;
    rdfs:label "Substance" ;
    rdfs:comment "This class has enumerated instances of the substances that are consumed, produced, transported, sensed, controlled or otherwise interacted with (e.g. water, air, etc.)." ;
    rdfs:subClassOf s223:EnumerationKind .

s223:hasPropertyShape a sh:PropertyShape ;
    rdfs:label "has Property Shape" ;
    rdfs:comment "Can be associated with a Property by hasProperty" ;
    sh:class s223:Property ;
    sh:path s223:hasProperty .

s223:cnx a s223:SymmetricProperty ;
    rdfs:label "cnx" ;
    rdfs:comment "The cnx property is a symmetric property used to associate adjacent entities in a connection path (comprised of Equipment-ConnectionPoint-Connection-ConnectionPoint-Equipment sequences)." .

s223:hasDomain a rdf:Property ;
    rdfs:label "has domain" ;
    rdfs:comment "The relation hasDomain is used to indicate what domain a Zone or DomainSpace pertains to (e.g. HVAC, lighting, electrical, etc.). Possible values are defined in EnumerationKind-Domain (see `s223:EnumerationKind-Domain`)." .

s223:mapsTo a rdf:Property ;
    rdfs:label "mapsTo" ;
    rdfs:comment "The relation mapsTo is used to associate a ConnectionPoint of an Equipment to a corresponding ConnectionPoint of the Equipment containing it. The associated ConnectionPoints must have the same direction (see `s223:EnumerationKind-Direction`)." .

s223:Sensor a s223:Class,
        sh:NodeShape ;
    rdfs:label "Sensor" ;
    rdfs:comment "A Sensor observes an ObservableProperty (see `s223:ObservableProperty`) which may be quantifiable (see `s223:QuantifiableObservableProperty`), such as a temperature, flowrate, or concentration, or Enumerable (see `s223:EnumeratedObservableProperty)`, such as an alarm state or occupancy state." ;
    rdfs:subClassOf s223:AbstractSensor ;
    sh:xone (
    [ sh:minCount 1 ;
                        sh:path ( s223:observesProperty qudt:hasQuantityKind ) ] [  sh:minCount 1 ;
                        sh:path ( s223:observesProperty s223:hasEnumerationKind ) ] 
    ) ;
    sh:property [ rdfs:comment "A sensor shall indicate its measurement location by the hasMeasurementLocation relation. Possible locations are a Connection, ConnectionPoint, Segment, DomainSpace, or Equipment." ;
            sh:minCount 1 ;
            sh:path s223:hasMeasurementLocation ;
            sh:xone ( [ sh:class s223:Connectable ] [ sh:class s223:Connection ] [ sh:class s223:Segment ] [ sh:class s223:ConnectionPoint ] ) ] ;
    sh:rule [ a sh:SPARQLRule ;
            rdfs:comment "Infer the hasMeasurementLocation relationship for a Sensor from the Property that it is observing" ;
            sh:construct """
CONSTRUCT {$this s223:hasMeasurementLocation ?something .}
WHERE {
{
SELECT ?prop (COUNT (DISTINCT ?measurementLocation) AS ?count) $this
WHERE {
FILTER (NOT EXISTS {$this s223:hasMeasurementLocation ?anything}) .
$this s223:observesProperty ?prop .
?measurementLocation s223:hasProperty ?prop .
}
GROUP BY ?prop $this
}
FILTER (?count = 1) .
?something s223:hasProperty ?prop .
{?something a/rdfs:subClassOf* s223:Connectable}
UNION
{?something a/rdfs:subClassOf* s223:Connection}
UNION
{?something a/rdfs:subClassOf* s223:Segment}
UNION
{?something a/rdfs:subClassOf* s223:ConnectionPoint}
}
""" ;
            sh:name "InferredMeasurementLocation" ;
            sh:prefixes <http://data.ashrae.org/standard223/1.0/inference/data-rules> ] .

s223:hasConnectionPoint a rdf:Property ;
    rdfs:label "has connection point" ;
    s223:inverseOf s223:isConnectionPointOf ;
    rdfs:comment "The relation hasConnectionPoint is part of a pair of relations that bind a Connectable thing to a ConnectionPoint. It is the inverse of the relation isConnectionPointOf (see `s223:isConnectionPointOf`)." .

s223:EnumerationKind-Medium a s223:Class,
        s223:EnumerationKind-Medium,
        sh:NodeShape ;
    rdfs:label "Medium" ;
    rdfs:subClassOf s223:EnumerationKind .

s223:Medium-Electricity a s223:Class,
        s223:Medium-Electricity,
        sh:NodeShape ;
    rdfs:label "Electricity" ;
    rdfs:subClassOf s223:EnumerationKind-Medium .

s223:Property a s223:Class,
        sh:NodeShape ;
    rdfs:label "Property" ;
    rdfs:comment """An attribute, quality, or characteristic of a feature of interest.

The Property class is the parent of all variations of a property, which are:
ActuatableProperty - parent of subclass of properties that can be modified by user or machine outside of the model (typically command)
ObservableProperty - parent of subclass of properties that can not be modified by user or machine outside of the model (typically measures)
EnumerableProperty - parent of subclass of properties defined by EnumerationKind
QuantifiableProperty - parent of subclass of properties defined by numerical values

And their different associations :
QuantifiableActuatableProperty
QuantifiableObservableProperty
EnumeratedObservableProperty
EnumeratedActuatableProperty

A QuantifiableProperty (or subClass thereof) must always be associated with a Unit and a QuantityKind, either explicitly from the Property, or through the associated Value. If the Unit is defined, the SHACL reasoner (if invoked) will figure out and assert the QuantityKind (the most general version).

Enumerable properties must be associated with an EnumerationKind.
""" ;
    rdfs:subClassOf s223:Concept ;
    sh:property [ rdfs:comment "A Property can be associated with any number of EnumerationKinds using the relation hasAspect" ;
            sh:class s223:EnumerationKind ;
            sh:path s223:hasAspect ],
        [ rdfs:comment "A Property can use at most one relation hasValue if it is required to provide a static value in the model. It is not meant for real-time value (see ref:hasExternalReference)" ;
            sh:maxCount 1 ;
            sh:path s223:hasValue ],
        [ rdfs:comment "A Property can be associated with at most one EnumerationKind-Medium using the relation ofMedium" ;
            sh:class s223:EnumerationKind-Medium ;
            sh:maxCount 1 ;
            sh:path s223:ofMedium ],
        [ rdfs:comment "A Property can be associated with at most one EnumerationKind-Substance using the relation ofSubstance" ;
            sh:class s223:EnumerationKind-Substance ;
            sh:maxCount 1 ;
            sh:path s223:ofSubstance ],
        [ rdfs:comment "A Property can be associated with any number of ExternalReferences using the relation hasExternalReference" ;
            sh:class ref:ExternalReference ;
            sh:path ref:hasExternalReference ] ;
    sh:sparql [ a sh:SPARQLConstraint ;
            rdfs:comment "A Property instance cannot be declared an instance of both an ActuatableProperty and an ObservableProperty." ;
            sh:message "{$this} cannot be declared an instance of both an ActuatableProperty and an ObservableProperty." ;
            sh:prefixes <http://data.ashrae.org/standard223/1.0/validation/model> ;
            sh:select """
SELECT $this
WHERE {
$this a/rdfs:subClassOf* s223:ActuatableProperty .
$this a/rdfs:subClassOf* s223:ObservableProperty .
}
""" ] .

s223:Connectable a s223:Class,
        sh:NodeShape ;
    rdfs:label "Connectable" ;
    s223:abstract true ;
    rdfs:comment "Connectable is an abstract class that represents a thing (Equipment or DomainSpace) that can be connected via ConnectionPoints and Connections." ;
    rdfs:subClassOf s223:Concept ;
    sh:property [ rdfs:comment "A Connectable can be associated with any number of other Connectables using the relation connected" ;
            sh:class s223:Connectable ;
            sh:name "SymmetricConnectableToConnectableShape" ;
            sh:path s223:connected ],
        [ rdfs:comment "A Connectable can be associated with any number of other Connectables using the relation connectedFrom" ;
            sh:class s223:Connectable ;
            sh:path s223:connectedFrom ],
        [ rdfs:comment "A Connectable can be associated with any number of Connections using the relation connectedThrough" ;
            sh:class s223:Connection ;
            sh:name "EquipmentToConnectionShape" ;
            sh:path s223:connectedThrough ],
        [ rdfs:comment "A Connectable can be associated with any number of other Connectables using the relation connectedTo" ;
            sh:class s223:Connectable ;
            sh:name "ConnectableToConnectableShape" ;
            sh:path s223:connectedTo ],
        [ rdfs:comment "A Connectable can be associated with any number of ConnectionPoints using the relation hasConnectionPoint" ;
            sh:class s223:ConnectionPoint ;
            sh:name "EquipmentToConnectionPointShape" ;
            sh:path s223:hasConnectionPoint ],
        [ rdfs:comment "A ConnectionPoint must be associated with Equipment or DomainSpace using the relation hasConnectionPoint." ;
            sh:message "This ConnectionPoint must be associated with Equipment or PhysicalSpace using the relation hasConnectionPoint." ;
            sh:path s223:isConnectionPointOf ;
            sh:severity sh:Info ],
        [ rdfs:comment "If a CP mapsTo another CP, the respective Equipment should have a contains relation." ;
            sh:path s223:mapsTo ;
            sh:sparql [ a sh:SPARQLConstraint ;
                    rdfs:comment "If a Connectable is s223:connected (high-level), it must eventually have the underlying cnx relations." ;
                    sh:message "{$this} is s223:connected (high-level) to {?otherC} but not yet connected at the cnx-level." ;
                    sh:prefixes <http://data.ashrae.org/standard223/1.0/validation/model> ;
                    sh:select """
SELECT $this ?otherC
WHERE {
$this s223:connected ?otherC .
FILTER NOT EXISTS {$this s223:cnx+ ?otherC}
}
""" ;
                    sh:severity sh:Warning ] ] ;
    sh:rule [ a sh:SPARQLRule ;
            s223:description "Infer the connected relationship for BiDirectional connections" ;
            sh:construct """
CONSTRUCT {$this s223:connected ?d2 .}
WHERE {
$this s223:connectedThrough/^s223:connectedThrough ?d2 .
FILTER ($this != ?d2) .
}
""" ;
            sh:name "InferredEquipmentToDownstreamEquipmentProperty" ;
            sh:prefixes <http://data.ashrae.org/standard223/1.0/inference/model-rules> ],
        [ a sh:TripleRule ;
            rdfs:comment "Infer the connected relationship using connectedFrom" ;
            sh:name "InferredEquipmentToEquipmentPropertyfromconnectedFrom" ;
            sh:object [ sh:path s223:connectedFrom ] ;
            sh:predicate s223:connected ;
            sh:subject sh:this ],
        [ a sh:TripleRule ;
            rdfs:comment "Infer the connected relationship using connectedTo" ;
            sh:name "InferredEquipmentToEquipmentPropertyfromconnectedTo" ;
            sh:object [ sh:path s223:connectedTo ] ;
            sh:predicate s223:connected ;
            sh:subject sh:this ],
        [ a sh:TripleRule ;
            rdfs:comment "Infer the connectedThrough relationship using hasConnectionPoint and connectsThrough" ;
            sh:name "InferredEquipmentToConnectionProperty" ;
            sh:object [ sh:path ( s223:hasConnectionPoint s223:connectsThrough ) ] ;
            sh:predicate s223:connectedThrough ;
            sh:subject sh:this ],
        [ a sh:TripleRule ;
            rdfs:comment "Infer the hasConnectionPoint relationship using cnx" ;
            sh:name "InferredEquipmentToConnectionPointProperty" ;
            sh:object [ sh:path s223:cnx ] ;
            sh:predicate s223:hasConnectionPoint ;
            sh:subject sh:this ],
        [ a sh:SPARQLRule ;
            rdfs:comment "Infer the connectedFrom relationship" ;
            sh:construct """
CONSTRUCT {$this s223:connectedFrom ?equipment .}
WHERE {
$this s223:hasConnectionPoint ?cp .
?cp a s223:InletConnectionPoint .
?cp s223:connectsThrough/s223:connectsFrom ?equipment .
}
""" ;
            sh:name "InferredEquipmentToUpstreamEquipmentProperty" ;
            sh:prefixes <http://data.ashrae.org/standard223/1.0/inference/model-rules> ],
        [ a sh:SPARQLRule ;
            rdfs:comment "Infer the connectedTo relationship" ;
            sh:construct """
CONSTRUCT {$this s223:connectedTo ?equipment .}
WHERE {
$this s223:hasConnectionPoint ?cp .
?cp a s223:OutletConnectionPoint .
?cp s223:connectsThrough/s223:connectsTo ?equipment .
}
""" ;
            sh:name "InferredEquipmentToDownstreamEquipmentProperty" ;
            sh:prefixes <http://data.ashrae.org/standard223/1.0/inference/model-rules> ],
        [ a sh:SPARQLRule ;
            rdfs:comment "Infer the connected relationship for BiDirectional connections" ;
            sh:construct """
CONSTRUCT {$this s223:connected ?d2 .}
WHERE {
$this s223:connectedThrough/^s223:connectedThrough ?d2 .
FILTER ($this != ?d2) .
FILTER NOT EXISTS {$this s223:contains* ?d2} .
FILTER NOT EXISTS {?d2 s223:contains* $this} .
}
""" ;
            sh:name "InferredEquipmentToDownstreamEquipmentProperty" ;
            sh:prefixes <http://data.ashrae.org/standard223/1.0/inference/model-rules> ],
        [ a sh:TripleRule ;
            rdfs:comment "Infer the cnx relationship from hasConnectionPoint" ;
            sh:name "InferredEquipmentToConnectionPointCnxProperty" ;
            sh:object [ sh:path s223:hasConnectionPoint ] ;
            sh:predicate s223:cnx ;
            sh:subject sh:this ],
        [ a sh:TripleRule ;
            rdfs:comment "Infer the cnx relationship from isConnectionPointOf" ;
            sh:name "InferredEquipmentToConnectionPointCnxPropertyFromInverse" ;
            sh:object [ sh:path [ sh:inversePath s223:isConnectionPointOf ] ] ;
            sh:predicate s223:cnx ;
            sh:subject sh:this ] .

s223:ConnectionPoint a s223:Class,
        sh:NodeShape ;
    rdfs:label "ConnectionPoint" ;
    s223:abstract true ;
    rdfs:comment """
A ConnectionPoint is an abstract modeling construct used to represent the fact that another piece of Equipment can be connected to another Equipment. It is the abstract representation of the flange, wire terminal, or other physical feature where a connection is made. In addition to Equipment, other connectable things (see `s223:Connectable`) can have one or more ConnectionPoints.

A ConnectionPoint can be constrained to relate to a specific medium such as air, water, or electricity which determines what other things can be connected to it. For example, by constraining a ConnectionPoint to be for air, it cannot be used for an electrical connection.

A ConnectionPoint belongs to exactly one connectable thing.

ConnectionPoints are represented graphically in this standard by a triangle with the point indicating a direction of flow, or a diamond in the case of a bidirectional connection as shown in Figure 5-2. 

![Figure 5-2. Graphical Representation of a ConnectionPoint.](figures/Figure_5-2_Graphical_Depiciton_of_Connection_Points.svg). 
 """ ;
    rdfs:subClassOf s223:Concept ;
    sh:property [ rdfs:comment "A ConnectionPoint should be associated with one Connection using the relation connectsThrough" ;
            sh:class s223:Connection ;
            sh:maxCount 1 ;
            sh:message "This ConnectionPoint should eventually be associated with exactly one Connection." ;
            sh:minCount 1 ;
            sh:name "ConnectionPointToConnectionShape" ;
            sh:path s223:connectsThrough ;
            sh:severity sh:Info ],
        [ rdfs:comment "A ConnectionPoint must be associated with one EnumerationKind-Medium using the relation hasMedium" ;
            sh:class s223:EnumerationKind-Medium ;
            sh:maxCount 1 ;
            sh:minCount 1 ;
            sh:name "ConnectionPoint medium" ;
            sh:path s223:hasMedium ],
        [ rdfs:comment "A ConnectionPoint can be associated with at most one Connectable using the relation isConnectionPointOf" ;
            sh:class s223:Connectable ;
            sh:maxCount 1 ;
            sh:name "ConnectionPointToEquipmentShape" ;
            sh:path s223:isConnectionPointOf ],
        [ rdfs:comment "A ConnectionPoint can be associated with any number of Segments using the relation lnx" ;
            sh:class s223:Segment ;
            sh:path s223:lnx ],
        [ rdfs:comment "A ConnectionPoint can be associated with at most one other ConnectionPoint using the relation mapsTo" ;
            sh:class s223:ConnectionPoint ;
            sh:maxCount 1 ;
            sh:path s223:mapsTo ],
        [ s223:description "If a CP mapsTo another CP, the respective Equipment should have a contains relation." ;
            sh:path s223:mapsTo ;
            sh:sparql [ a sh:SPARQLConstraint ;
                    rdfs:comment "If a CP mapsTo another CP, the respective Equipment should have a contains relation." ;
                    sh:message "{?otherEquipment} should contain {?equipment} because ConnectionPoint {$this} has a mapsTo relation." ;
                    sh:prefixes <http://data.ashrae.org/standard223/1.0/validation/model> ;
                    sh:select """
SELECT $this ?equipment ?otherEquipment
WHERE {
$this s223:mapsTo ?otherCP .
?equipment s223:hasConnectionPoint $this .
?otherEquipment s223:hasConnectionPoint ?otherCP .
FILTER NOT EXISTS {?otherEquipment s223:contains ?equipment}
}
""" ] ],
        [ sh:name "Test for compatible declared Medium" ;
            sh:path s223:hasMedium ;
            sh:sparql [ a sh:SPARQLConstraint ;
                    rdfs:comment "Ensure that the Medium identified by a ConnectionPoint via the s223:hasMedium relation is compatible with the Medium identified by the entity identified by the mapsTo+ relation." ;
                    sh:message "{$this} declares a Medium of {?a}, but the Medium of {?b} is declared by {?target} pointed to by the mapsTo+ relation." ;
                    sh:prefixes <http://data.ashrae.org/standard223/1.0/validation/model> ;
                    sh:select """
SELECT DISTINCT $this ?a ?b ?target
WHERE {
$this s223:hasMedium ?a .
$this s223:mapsTo+ ?target .
?target s223:hasMedium ?b .
?a a/rdfs:subClassOf* s223:EnumerationKind-Medium .
?b a/rdfs:subClassOf* s223:EnumerationKind-Medium .
FILTER (?a != ?b ) .
FILTER (NOT EXISTS {?b a/rdfs:subClassOf* ?a}) .
FILTER (NOT EXISTS {?a a/rdfs:subClassOf* ?b}) .
}
""" ] ],
        [ s223:description "A ConnectionPoint must be associated with Equipment or DomainSpace using the relation hasConnectionPoint." ;
            sh:message "This ConnectionPoint must be associated with Equipment or PhysicalSpace using the relation hasConnectionPoint." ;
            sh:path s223:isConnectionPointOf ;
            sh:severity sh:Info ],
        s223:hasPropertyShape .

s223:EnumerationKind-Domain a s223:Class,
        s223:EnumerationKind-Domain,
        sh:NodeShape ;
    rdfs:label "EnumerationKind Domain" ;
    rdfs:subClassOf s223:EnumerationKind .

<http://data.ashrae.org/standard223/1.0/validation/model> a owl:Ontology ;
    owl:imports <http://data.ashrae.org/standard223/1.0/model/all> ;
    owl:versionInfo "Created with TopBraid Composer" ;
    sh:declare [ sh:namespace "http://data.ashrae.org/standard223#"^^xsd:anyURI ;
            sh:prefix "s223" ],
        [ sh:namespace "http://data.ashrae.org/standard223/1.0/vocab/enumeration#"^^xsd:anyURI ;
            sh:prefix "enum" ],
        [ sh:namespace "http://qudt.org/schema/qudt/"^^xsd:anyURI ;
            sh:prefix "qudt" ],
        [ sh:namespace "http://qudt.org/vocab/quantitykind/"^^xsd:anyURI ;
            sh:prefix "quantitykind" ],
        [ sh:namespace "http://www.w3.org/1999/02/22-rdf-syntax-ns#"^^xsd:anyURI ;
            sh:prefix "rdf" ],
        [ sh:namespace "http://www.w3.org/2000/01/rdf-schema#"^^xsd:anyURI ;
            sh:prefix "rdfs" ],
        [ sh:namespace "http://data.ashrae.org/standard223/1.0/vocab/role#"^^xsd:anyURI ;
            sh:prefix "role" ],
        [ sh:namespace "http://qudt.org/vocab/quantitykind/"^^xsd:anyURI ;
            sh:prefix "qudtqk" ],
        [ sh:namespace "http://qudt.org/vocab/unit/"^^xsd:anyURI ;
            sh:prefix "unit" ],
        [ sh:namespace "http://www.w3.org/ns/shacl#"^^xsd:anyURI ;
            sh:prefix "sh" ] .

s223:EnumerationKind-Role a s223:Class,
        s223:EnumerationKind-Role,
        sh:NodeShape ;
    rdfs:label "Role" ;
    rdfs:subClassOf s223:EnumerationKind .

s223:EnumerationKind a s223:Class,
        sh:NodeShape ;
    rdfs:label "Enumeration kind" ;
    rdfs:comment "This is the encapsulating class for all EnumerationKinds. EnumerationKinds define the (closed) set of permissible values for a given purpose. For example, the DayOfWeek EnumerationKind enumerates the days of the week and allows no other values." ;
    rdfs:subClassOf s223:Concept .

s223:Concept a s223:Class,
        sh:NodeShape ;
    rdfs:label "Concept" ;
    s223:abstract true ;
    rdfs:comment "This is the superclass of all classes defined in the 223 standard." ;
    rdfs:subClassOf rdfs:Resource ;
    sh:property [ rdfs:comment "A Concept can use the relation cnx" ;
            sh:path s223:cnx ],
        [ rdfs:comment "A Concept can use the relation hasProperty" ;
            sh:path s223:hasProperty ],
        [ rdfs:comment "A Concept can use the relation label" ;
            sh:path rdfs:label ] ;
    sh:sparql [ a sh:SPARQLConstraint ;
            rdfs:comment "Ensure that any instance that is declared to be an instance of an abstract class must also be declared an instance of at least one subClass of that abstract class" ;
            sh:message "{$this} cannot be declared an instance of only abstract class {?class}." ;
            sh:prefixes <http://data.ashrae.org/standard223/1.0/validation/model> ;
            sh:select """
SELECT DISTINCT $this ?class
WHERE {
?class s223:abstract true .
$this a ?class .
OPTIONAL {
?otherClass rdfs:subClassOf+ ?class .
$this a ?otherClass .
FILTER (?class != ?otherClass) .
}
FILTER (!bound (?otherClass)) .
}
""" ] .

s223:Equipment a s223:Class,
        sh:NodeShape ;
    rdfs:label "Equipment" ;
    rdfs:comment "A Equipment is the modeling construct used to represent a physical entity or piece of mechanical equipment that one might buy from a vendor - a tangible object designed to accomplish a specific task. Examples of possible devices include a pump, fan, heat exchanger, luminaire, temperature sensor, or flow meter." ;
    rdfs:subClassOf s223:Connectable ;
    sh:property [ a sh:PropertyShape ;
            rdfs:comment "A Equipment can be associated with Equipment by contains" ;
            sh:class s223:Equipment ;
            sh:minCount 0 ;
            sh:name "device contains shape" ;
            sh:path s223:contains ],
        [ rdfs:comment "A Equipment can be associated with an ActuatableProperty by commandedByProperty" ;
            sh:class s223:ActuatableProperty ;
            sh:path s223:commandedByProperty ],
        [ rdfs:comment "A Equipment can be associated with a PhysicalSpace by hasPhysicalLocation" ;
            sh:class s223:PhysicalSpace ;
            sh:path s223:hasPhysicalLocation ],
        [ rdfs:comment "A Equipment can be associated with an EnumerationKind-Role by hasRole" ;
            sh:class s223:EnumerationKind-Role ;
            sh:path s223:hasRole ],
        [ rdfs:comment "Make sure that a containing Equipment inherits the incoming connectedFrom relations of contained Equipment if they are not internal connections." ;
            sh:path s223:connectedFrom ;
            sh:sparql [ a sh:SPARQLConstraint ;
                    rdfs:comment "Make sure that a containing Equipment inherits the incoming connectedFrom relations of contained Equipment if they are not internal connections." ;
                    sh:message "{?container} does not have a connectedFrom relation to {?otherDev} even though {?container} contains {$this} which does." ;
                    sh:prefixes <http://data.ashrae.org/standard223/1.0/validation/model> ;
                    sh:select """
SELECT $this ?container ?otherDev
WHERE {
$this s223:connectedFrom ?otherDev .
$this ^s223:contains ?container .
FILTER NOT EXISTS {?container s223:contains ?otherDev .}
FILTER NOT EXISTS {?container s223:connectedFrom ?otherDev .}
}
""" ] ],
        [ rdfs:comment "Make sure that a containing Equipment inherits the outgoing connectedTo relations of contained Equipment if they are not internal connections." ;
            sh:path s223:connectedTo ;
            sh:sparql [ a sh:SPARQLConstraint ;
                    rdfs:comment "Make sure that a containing Equipment inherits the outgoing connectedTo relations of contained Equipment if they are not internal connections." ;
                    sh:message "{?container} does not have a connectedTo relation to {?otherDev} even though {?container} contains {$this} which does." ;
                    sh:prefixes <http://data.ashrae.org/standard223/1.0/validation/model> ;
                    sh:select """
SELECT $this ?container ?otherDev
WHERE {
$this s223:connectedTo ?otherDev .
$this ^s223:contains ?container .
FILTER NOT EXISTS {?container s223:contains ?otherDev .}
FILTER NOT EXISTS {?container s223:connectedTo ?otherDev .}
}
""" ] ],
        s223:hasPropertyShape ;
    sh:rule [ a sh:SPARQLRule ;
            rdfs:comment "Infer a higher-level cnx and Medium from the mapsTo relation" ;
            sh:construct """
CONSTRUCT {?parentCp s223:cnx ?connection .
    ?parentCp s223:hasMedium ?medium .
}
WHERE {
  $this s223:hasConnectionPoint ?cp .
  ?cp s223:mapsTo ?parentCp .
  ?cp s223:connectsThrough ?connection .
  ?cp s223:hasMedium ?medium .
}
""" ;
            sh:prefixes <http://data.ashrae.org/standard223/1.0/inference/model-rules> ] .

rdf:Property a sh:NodeShape ;
    sh:property [ rdfs:comment "This Property must have aa label" ;
            sh:path rdfs:label ;
            sh:sparql [ a sh:SPARQLConstraint ;
                    sh:message "{$this} must have an rdfs:label" ;
                    sh:prefixes <http://data.ashrae.org/standard223/1.0/validation/schema> ;
                    sh:select """
SELECT $this
WHERE {
BIND(REPLACE(STR($this), "^(.*)(/|#)([^#/]*)$", "$1") AS ?prop) .
FILTER (?prop = "http://data.ashrae.org/standard223") .
FILTER (NOT EXISTS {$this rdfs:label ?something}) .
}
""" ] ] .

[] sh:minCount 1 .

[] sh:maxCount 1 .

