
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Model Validation &#8212; BuildingMOTIF Documentation</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Model Correction" href="model_correction.html" />
    <link rel="prev" title="Model Creation" href="model_creation.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint">⚠️ This is an ALPHA release, things may break or not work! ⚠️</div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">BuildingMOTIF Documentation</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../README.html">
                    BuildingMOTIF
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Tutorials
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="model_creation.html">
   Model Creation
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Model Validation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="model_correction.html">
   Model Correction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="template_writing.html">
   Template Writing
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Reference
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../reference/apidoc/index.html">
   Code Documentation
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../reference/apidoc/_autosummary/buildingmotif.html">
     buildingmotif
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../reference/apidoc/_autosummary/buildingmotif.api.html">
       buildingmotif.api
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
      <label for="toctree-checkbox-3">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../reference/apidoc/_autosummary/buildingmotif.api.app.html">
         buildingmotif.api.app
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../reference/apidoc/_autosummary/buildingmotif.api.views.html">
         buildingmotif.api.views
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../reference/apidoc/_autosummary/buildingmotif.building_motif.html">
       buildingmotif.building_motif
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
      <label for="toctree-checkbox-4">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../reference/apidoc/_autosummary/buildingmotif.building_motif.building_motif.html">
         buildingmotif.building_motif.building_motif
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../reference/apidoc/_autosummary/buildingmotif.building_motif.singleton.html">
         buildingmotif.building_motif.singleton
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../reference/apidoc/_autosummary/buildingmotif.database.html">
       buildingmotif.database
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
      <label for="toctree-checkbox-5">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../reference/apidoc/_autosummary/buildingmotif.database.graph_connection.html">
         buildingmotif.database.graph_connection
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../reference/apidoc/_autosummary/buildingmotif.database.table_connection.html">
         buildingmotif.database.table_connection
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../reference/apidoc/_autosummary/buildingmotif.database.tables.html">
         buildingmotif.database.tables
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../reference/apidoc/_autosummary/buildingmotif.database.utils.html">
         buildingmotif.database.utils
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3 has-children">
      <a class="reference internal" href="../reference/apidoc/_autosummary/buildingmotif.dataclasses.html">
       buildingmotif.dataclasses
      </a>
      <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
      <label for="toctree-checkbox-6">
       <i class="fas fa-chevron-down">
       </i>
      </label>
      <ul>
       <li class="toctree-l4">
        <a class="reference internal" href="../reference/apidoc/_autosummary/buildingmotif.dataclasses.library.html">
         buildingmotif.dataclasses.library
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../reference/apidoc/_autosummary/buildingmotif.dataclasses.model.html">
         buildingmotif.dataclasses.model
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../reference/apidoc/_autosummary/buildingmotif.dataclasses.shape_collection.html">
         buildingmotif.dataclasses.shape_collection
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../reference/apidoc/_autosummary/buildingmotif.dataclasses.template.html">
         buildingmotif.dataclasses.template
        </a>
       </li>
       <li class="toctree-l4">
        <a class="reference internal" href="../reference/apidoc/_autosummary/buildingmotif.dataclasses.validation.html">
         buildingmotif.dataclasses.validation
        </a>
       </li>
      </ul>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../reference/apidoc/_autosummary/buildingmotif.namespaces.html">
       buildingmotif.namespaces
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../reference/apidoc/_autosummary/buildingmotif.template_compilation.html">
       buildingmotif.template_compilation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../reference/apidoc/_autosummary/buildingmotif.template_matcher.html">
       buildingmotif.template_matcher
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../reference/apidoc/_autosummary/buildingmotif.utils.html">
       buildingmotif.utils
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../reference/developer_documentation.html">
   Developer Documentation
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Appendix
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../bibliography.html">
   Bibliography
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/NREL/BuildingMOTIF/main?urlpath=tree/docs/tutorials/model_validation.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/NREL/BuildingMOTIF"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/NREL/BuildingMOTIF/issues/new?title=Issue%20on%20page%20%2Ftutorials/model_validation.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/tutorials/model_validation.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download notebook file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        <a href="../_sources/tutorials/model_validation.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#setup">
   Setup
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#model-validation-ontology">
   Model Validation - Ontology
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#model-validation-manifest">
   Model Validation - Manifest
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#writing-a-manifest">
     Writing a Manifest
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#validating-the-model">
     Validating the Model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fixing-the-model">
     Fixing the Model
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#model-validation-use-case">
   Model Validation - Use Case
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-use-case-shapes">
     Finding Use Case Shapes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     Validating the Model
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Model Validation</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#setup">
   Setup
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#model-validation-ontology">
   Model Validation - Ontology
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#model-validation-manifest">
   Model Validation - Manifest
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#writing-a-manifest">
     Writing a Manifest
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#validating-the-model">
     Validating the Model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fixing-the-model">
     Fixing the Model
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#model-validation-use-case">
   Model Validation - Use Case
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-use-case-shapes">
     Finding Use Case Shapes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     Validating the Model
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="model-validation">
<h1>Model Validation<a class="headerlink" href="#model-validation" title="Permalink to this headline">#</a></h1>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>This tutorial assumes that <code class="docutils literal notranslate"><span class="pre">BuildingMOTIF</span></code> has already been installed in the local environment.</p>
</div>
</aside>
<p>The purpose of this tutorial is to learn about model <em>validation</em> and how BuildingMOTIF can give useful feedback for fixing a model that has failed validation.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This tutorial has the following learning objectives:</p>
<ol class="simple">
<li><p>validating the model against an <em><strong>ontology</strong></em> to ensure that the model is a valid Brick model</p></li>
<li><p>validating the model against a <em><strong>manifest</strong></em>, which contains the metadata requirements for a specific model</p></li>
<li><p>validating the model against a <em><strong>use case</strong></em> for a specific application</p></li>
</ol>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">Shapes</span></code> are functions that validate part of an RDF model. A <code class="docutils literal notranslate"><span class="pre">Shape</span></code> is a set of constraints, requirements, and/or rules that apply to entities in an RDF graph. A shape may represent many things, including:</p>
<ul class="simple">
<li><p>the minimum points on an equipment required to execute a certain sequence of operations,</p></li>
<li><p>the internal details of an equipment: what parts it contains, etc</p></li>
</ul>
</div>
</aside>
<p>Validating a model is the process of ensuring that the model is both <em>correct</em> (uses the ontologies correctly) and <em>semantically sufficient</em> (it contains sufficient metadata to execute the desired applications or enable the desired use cases). Validation is always done with respect to sets of <code class="docutils literal notranslate"><span class="pre">Shapes</span></code> using the Shapes Constraint Language (SHACL)<a class="footnote-reference brackets" href="#id4" id="id1">1</a>.</p>
<section id="setup">
<h2>Setup<a class="headerlink" href="#setup" title="Permalink to this headline">#</a></h2>
<p>We create an in-memory BuildingMOTIF instance, load the model from the previous tutorial, and load some libraries to create the manifest with. The <code class="docutils literal notranslate"><span class="pre">constraints.ttl</span></code> library we load is a special library with some custom constraints defined that are helpful for writing manifests.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from rdflib import Namespace
from buildingmotif import BuildingMOTIF
from buildingmotif.dataclasses import Model, Library
from buildingmotif.namespaces import BRICK # import this to make writing URIs easier

# in-memory instance
bm = BuildingMOTIF(&quot;sqlite://&quot;)

# create the namespace for the building
BLDG = Namespace(&#39;urn:bldg/&#39;)

# create the building model
model = Model.create(BLDG, description=&quot;This is a test model for a simple building&quot;)

# load tutorial 1 model
model.graph.parse(&quot;tutorial1_model.ttl&quot;, format=&quot;ttl&quot;)

# load in some libraries
brick = Library.load(ontology_graph=&quot;../../libraries/brick/Brick-subset.ttl&quot;)
constraints = Library.load(ontology_graph=&quot;../../buildingmotif/resources/constraints.ttl&quot;)
g36 = Library.load(directory=&quot;../../libraries/ashrae/guideline36&quot;)
</pre></div>
</div>
</div>
</div>
</section>
<section id="model-validation-ontology">
<h2>Model Validation - Ontology<a class="headerlink" href="#model-validation-ontology" title="Permalink to this headline">#</a></h2>
<p>BuildingMOTIF organizes Shapes into <code class="docutils literal notranslate"><span class="pre">Shape</span> <span class="pre">Collections</span></code>. The shape collection associated with a library (if there is one) can be retrieved with the <code class="docutils literal notranslate"><span class="pre">get_shape_collection</span></code> property. Below, we use Brick’s shape collection to ensure that the model is using Brick correctly:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># pass a list of shape collections to .validate()
validation_result = model.validate([brick.get_shape_collection()])
print(f&quot;Model is valid? {validation_result.valid}&quot;)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model is valid? True
</pre></div>
</div>
</div>
</div>
<p>Success! The model is valid according to the Brick ontology.</p>
</section>
<section id="model-validation-manifest">
<h2>Model Validation - Manifest<a class="headerlink" href="#model-validation-manifest" title="Permalink to this headline">#</a></h2>
<section id="writing-a-manifest">
<h3>Writing a Manifest<a class="headerlink" href="#writing-a-manifest" title="Permalink to this headline">#</a></h3>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A <code class="docutils literal notranslate"><span class="pre">manifest</span></code> is an RDF graph with a set of <code class="docutils literal notranslate"><span class="pre">Shapes</span></code> inside, which place constraints and requirements on what metadata must be contained within a metadata model.</p>
</div>
</aside>
<p>For now, we will write a <code class="docutils literal notranslate"><span class="pre">manifest</span></code> file directly; in the future, BuildingMOTIF will contain features that make manifests easier to write. Here is the header of a manifest file. This should also suffice for most of your own manifests.</p>
<div class="highlight-ttl notranslate"><div class="highlight"><pre><span></span>@<span class="nv">prefix</span><span class="w"> </span><span class="nv">brick</span>:<span class="w"> </span><span class="o">&lt;</span><span class="nv">https</span>:<span class="o">//</span><span class="nv">brickschema</span>.<span class="nv">org</span><span class="o">/</span><span class="nv">schema</span><span class="o">/</span><span class="nv">Brick</span>#<span class="o">&gt;</span><span class="w"> </span>.<span class="w"></span>
@<span class="nv">prefix</span><span class="w"> </span><span class="nv">owl</span>:<span class="w"> </span><span class="o">&lt;</span><span class="nv">http</span>:<span class="o">//</span><span class="nv">www</span>.<span class="nv">w3</span>.<span class="nv">org</span><span class="o">/</span><span class="mi">2002</span><span class="o">/</span><span class="mi">07</span><span class="o">/</span><span class="nv">owl</span>#<span class="o">&gt;</span><span class="w"> </span>.<span class="w"></span>
@<span class="nv">prefix</span><span class="w"> </span><span class="nv">sh</span>:<span class="w"> </span><span class="o">&lt;</span><span class="nv">http</span>:<span class="o">//</span><span class="nv">www</span>.<span class="nv">w3</span>.<span class="nv">org</span><span class="o">/</span><span class="nv">ns</span><span class="o">/</span><span class="nv">shacl</span>#<span class="o">&gt;</span><span class="w"> </span>.<span class="w"></span>
@<span class="nv">prefix</span><span class="w"> </span><span class="nv">constraint</span>:<span class="w"> </span><span class="o">&lt;</span><span class="nv">https</span>:<span class="o">//</span><span class="nv">nrel</span>.<span class="nv">gov</span><span class="o">/</span><span class="nv">BuildingMOTIF</span><span class="o">/</span><span class="nv">constraints</span>#<span class="o">&gt;</span><span class="w"> </span>.<span class="w"></span>
@<span class="nv">prefix</span><span class="w"> </span>:<span class="w"> </span><span class="o">&lt;</span><span class="nv">urn</span>:<span class="nv">my_site_constraints</span><span class="o">/&gt;</span><span class="w"> </span>.<span class="w"></span>

:<span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">owl</span>:<span class="nv">Ontology</span><span class="w"> </span>.<span class="w"></span>
</pre></div>
</div>
<p>We will now add a constraint stating that the model should contain exactly 1 Brick AHU.</p>
<div class="highlight-ttl notranslate"><div class="highlight"><pre><span></span><span class="nl">:ahu</span><span class="o">-</span><span class="nv">count</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">sh</span>:<span class="nv">NodeShape</span><span class="w"> </span><span class="c1">;</span><span class="w"></span>
<span class="w">    </span><span class="nv">sh</span>:<span class="nv">message</span><span class="w"> </span><span class="s2">&quot;need 1 AHU&quot;</span><span class="w"> </span><span class="c1">;</span><span class="w"></span>
<span class="w">    </span><span class="nv">sh</span>:<span class="nv">targetNode</span><span class="w"> </span>:<span class="w"> </span><span class="c1">;</span><span class="w"></span>
<span class="w">    </span><span class="nv">constraint</span>:<span class="nv">exactCount</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="c1">;</span><span class="w"></span>
<span class="w">    </span><span class="nv">constraint</span>:<span class="nv">class</span><span class="w"> </span><span class="nv">brick</span>:<span class="nv">AHU</span><span class="w"> </span>.<span class="w"></span>
</pre></div>
</div>
<p>This basic structure can be changed to require different numbers of different Brick classes. Just don’t forget to change the name of the shape (<code class="docutils literal notranslate"><span class="pre">:ahu-count</span></code>, above) when you copy-paste!</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>As an exercise, try writing shapes that require the model to have the following.</p>
<ul class="simple">
<li><p>(1) Brick Supply_Fan</p></li>
<li><p>(1) Brick Damper</p></li>
<li><p>(1) Brick Cooling_Coil</p></li>
<li><p>(1) Brick Heating_Coil</p></li>
</ul>
</div>
<div class="dropdown admonition hint">
<p class="admonition-title">Hint</p>
<div class="highlight-ttl notranslate"><div class="highlight"><pre><span></span><span class="nl">:fan</span><span class="o">-</span><span class="nv">count</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">sh</span>:<span class="nv">NodeShape</span><span class="w"> </span><span class="c1">;</span><span class="w"></span>
<span class="w">    </span><span class="nv">sh</span>:<span class="nv">message</span><span class="w"> </span><span class="s2">&quot;need 1 supply fan&quot;</span><span class="w"> </span><span class="c1">;</span><span class="w"></span>
<span class="w">    </span><span class="nv">sh</span>:<span class="nv">targetNode</span><span class="w"> </span>:<span class="w"> </span><span class="c1">;</span><span class="w"></span>
<span class="w">    </span><span class="nv">constraint</span>:<span class="nv">exactCount</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="c1">;</span><span class="w"></span>
<span class="w">    </span><span class="nv">constraint</span>:<span class="nv">class</span><span class="w"> </span><span class="nv">brick</span>:<span class="nv">Supply_Fan</span><span class="w"> </span>.<span class="w"></span>

<span class="nl">:damper</span><span class="o">-</span><span class="nv">count</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">sh</span>:<span class="nv">NodeShape</span><span class="w"> </span><span class="c1">;</span><span class="w"></span>
<span class="w">    </span><span class="nv">sh</span>:<span class="nv">message</span><span class="w"> </span><span class="s2">&quot;need 1 damper&quot;</span><span class="w"> </span><span class="c1">;</span><span class="w"></span>
<span class="w">    </span><span class="nv">sh</span>:<span class="nv">targetNode</span><span class="w"> </span>:<span class="w"> </span><span class="c1">;</span><span class="w"></span>
<span class="w">    </span><span class="nv">constraint</span>:<span class="nv">exactCount</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="c1">;</span><span class="w"></span>
<span class="w">    </span><span class="nv">constraint</span>:<span class="nv">class</span><span class="w"> </span><span class="nv">brick</span>:<span class="nv">Damper</span><span class="w"> </span>.<span class="w"></span>

<span class="nl">:clg</span><span class="o">-</span><span class="nv">coil</span><span class="o">-</span><span class="nv">count</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">sh</span>:<span class="nv">NodeShape</span><span class="w"> </span><span class="c1">;</span><span class="w"></span>
<span class="w">    </span><span class="nv">sh</span>:<span class="nv">message</span><span class="w"> </span><span class="s2">&quot;need 1 cooling coil&quot;</span><span class="w"> </span><span class="c1">;</span><span class="w"></span>
<span class="w">    </span><span class="nv">sh</span>:<span class="nv">targetNode</span><span class="w"> </span>:<span class="w"> </span><span class="c1">;</span><span class="w"></span>
<span class="w">    </span><span class="nv">constraint</span>:<span class="nv">exactCount</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="c1">;</span><span class="w"></span>
<span class="w">    </span><span class="nv">constraint</span>:<span class="nv">class</span><span class="w"> </span><span class="nv">brick</span>:<span class="nv">Cooling_Coil</span><span class="w"> </span>.<span class="w"></span>

<span class="nl">:htg</span><span class="o">-</span><span class="nv">coil</span><span class="o">-</span><span class="nv">count</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">sh</span>:<span class="nv">NodeShape</span><span class="w"> </span><span class="c1">;</span><span class="w"></span>
<span class="w">    </span><span class="nv">sh</span>:<span class="nv">message</span><span class="w"> </span><span class="s2">&quot;need 1 heating coil&quot;</span><span class="w"> </span><span class="c1">;</span><span class="w"></span>
<span class="w">    </span><span class="nv">sh</span>:<span class="nv">targetNode</span><span class="w"> </span>:<span class="w"> </span><span class="c1">;</span><span class="w"></span>
<span class="w">    </span><span class="nv">constraint</span>:<span class="nv">exactCount</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="c1">;</span><span class="w"></span>
<span class="w">    </span><span class="nv">constraint</span>:<span class="nv">class</span><span class="w"> </span><span class="nv">brick</span>:<span class="nv">Heating_Coil</span><span class="w"> </span>.<span class="w"></span>
</pre></div>
</div>
</div>
<!-- We can now add a shape that requires *all* AHUs in the model to match the `sz-vav-ahu` system specification we find above:

```ttl
:sz-vav-ahu-control-sequences a sh:NodeShape ;
    sh:message "AHUs must match the single-zone VAV AHU shape" ;
    sh:targetClass brick:AHU ;
    sh:node <urn:ashrae/g36/4.8/sz-vav-ahu/sz-vav-ahu> .
``` -->
<p>Put all of the above in a new file called <code class="docutils literal notranslate"><span class="pre">tutorial2_manifest.ttl</span></code>. We’ll also add a shape called <code class="docutils literal notranslate"><span class="pre">sz-vav-ahu-control-sequences</span></code>, which is a use case shape to validate the model against in the next section.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>with open(&quot;tutorial2_manifest.ttl&quot;, &quot;w&quot;) as f:
    f.write(&quot;&quot;&quot;
@prefix brick: &lt;https://brickschema.org/schema/Brick#&gt; .
@prefix owl: &lt;http://www.w3.org/2002/07/owl#&gt; .
@prefix sh: &lt;http://www.w3.org/ns/shacl#&gt; .
@prefix constraint: &lt;https://nrel.gov/BuildingMOTIF/constraints#&gt; .
@prefix : &lt;urn:my_site_constraints/&gt; .

: a owl:Ontology .

:ahu-count a sh:NodeShape ;
    sh:message &quot;need 1 AHU&quot; ;
    sh:targetNode : ;
    constraint:exactCount 1 ;
    constraint:class brick:AHU .

:fan-count a sh:NodeShape ;
    sh:message &quot;need 1 supply fan&quot; ;
    sh:targetNode : ;
    constraint:exactCount 1 ;
    constraint:class brick:Supply_Fan .

:damper-count a sh:NodeShape ;
    sh:message &quot;need 1 damper&quot; ;
    sh:targetNode : ;
    constraint:exactCount 1 ;
    constraint:class brick:Damper .

:clg-coil-count a sh:NodeShape ;
    sh:message &quot;need 1 cooling coil&quot; ;
    sh:targetNode : ;
    constraint:exactCount 1 ;
    constraint:class brick:Cooling_Coil .

:htg-coil-count a sh:NodeShape ;
    sh:message &quot;need 1 heating coil&quot; ;
    sh:targetNode : ;
    constraint:exactCount 1 ;
    constraint:class brick:Heating_Coil .

:sz-vav-ahu-control-sequences a sh:NodeShape ;
    sh:message &quot;AHUs must match the single-zone VAV AHU shape&quot; ;
    sh:targetClass brick:AHU ;
    sh:node &lt;urn:ashrae/g36/4.8/sz-vav-ahu/sz-vav-ahu&gt; .
&quot;&quot;&quot;)
</pre></div>
</div>
</div>
</div>
</section>
<section id="validating-the-model">
<h3>Validating the Model<a class="headerlink" href="#validating-the-model" title="Permalink to this headline">#</a></h3>
<p>We can now ask BuildingMOTIF to validate the model against the manifest and ask BuildingMOTIF for some details if it fails. We also have to be sure to include the supporting shape collections containing the definitions used in the manifest.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># load manifest into BuildingMOTIF as its own library!
manifest = Library.load(ontology_graph=&quot;tutorial2_manifest.ttl&quot;)

# gather shape collections into a list for ease of use
shape_collections = [
    brick.get_shape_collection(),
    constraints.get_shape_collection(),
    manifest.get_shape_collection(),
    g36.get_shape_collection(),
]

# pass a list of shape collections to .validate()
validation_result = model.validate(shape_collections)
print(f&quot;Model is valid? {validation_result.valid}&quot;)

# print reasons
for diff in validation_result.diffset:
    print(f&quot; - {diff.reason()}&quot;)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model is valid? False
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> - urn:bldg/Core_ZN-PSC_AC needs between 1 and 1 instances of urn:ashrae/g36/4.8/sz-vav-ahu/sa-fan on path https://brickschema.org/schema/Brick#hasPart
 - Graph did not have 1 instances of https://brickschema.org/schema/Brick#Heating_Coil
</pre></div>
</div>
</div>
</div>
</section>
<section id="fixing-the-model">
<h3>Fixing the Model<a class="headerlink" href="#fixing-the-model" title="Permalink to this headline">#</a></h3>
<p>The model is failing because we don’t have a heating coil required by the manifest, which we forgot to add in the previous tutorial. It’s also failing the use case validation, which we’ll cover in the next section. To fix the manifest validation, use the equipment templates in the Brick library to create a heating coil, add it to the model, and connect it to the AHU using RDFLib’s <code class="docutils literal notranslate"><span class="pre">graph.add()</span></code> method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># ahu name
ahu_name = &quot;Core_ZN-PSC_AC&quot;

# get template
htg_coil_template = brick.get_template_by_name(BRICK.Heating_Coil)

# add htg coil
htg_coil_name = f&quot;{ahu_name}-Htg_Coil&quot;
htg_coil_binding = {&quot;name&quot;: BLDG[htg_coil_name]}
htg_coil_graph = htg_coil_template.evaluate(htg_coil_binding)
model.add_graph(htg_coil_graph)

# connect htg coil
model.graph.add((BLDG[ahu_name], BRICK.hasPart, BLDG[htg_coil_name]))

# print model to confirm component was added and connected
print(model.graph.serialize())
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>@prefix brick: &lt;https://brickschema.org/schema/Brick#&gt; .
@prefix owl: &lt;http://www.w3.org/2002/07/owl#&gt; .

&lt;urn:bldg/&gt; a owl:Ontology .

&lt;urn:bldg/Core_ZN-PSC_AC&gt; a brick:AHU ;
    brick:hasPart &lt;urn:bldg/Core_ZN-PSC_AC-Clg_Coil&gt;,
        &lt;urn:bldg/Core_ZN-PSC_AC-Damper&gt;,
        &lt;urn:bldg/Core_ZN-PSC_AC-Fan&gt;,
        &lt;urn:bldg/Core_ZN-PSC_AC-Htg_Coil&gt; .

&lt;urn:bldg/Core_ZN-PSC_AC-Clg_Coil&gt; a brick:Cooling_Coil .

&lt;urn:bldg/Core_ZN-PSC_AC-Damper&gt; a brick:Damper .

&lt;urn:bldg/Core_ZN-PSC_AC-Fan&gt; a brick:Supply_Fan .

&lt;urn:bldg/Core_ZN-PSC_AC-Htg_Coil&gt; a brick:Heating_Coil .
</pre></div>
</div>
</div>
</div>
<p>We can see that the heating coil was added to the model and connected to the AHU so let’s check if the manifest validation failure was fixed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># pass a list of shape collections to .validate()
validation_result = model.validate(shape_collections)
print(f&quot;Model is valid? {validation_result.valid}&quot;)

# print reasons
for diff in validation_result.diffset:
    print(f&quot; - {diff.reason()}&quot;)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Model is valid? False
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> - urn:bldg/Core_ZN-PSC_AC needs between 1 and 1 instances of urn:ashrae/g36/4.8/sz-vav-ahu/sa-fan on path https://brickschema.org/schema/Brick#hasPart
</pre></div>
</div>
</div>
</div>
<p>Success! The model is no longer failing the manifest validation.</p>
</section>
</section>
<section id="model-validation-use-case">
<h2>Model Validation - Use Case<a class="headerlink" href="#model-validation-use-case" title="Permalink to this headline">#</a></h2>
<section id="finding-use-case-shapes">
<h3>Finding Use Case Shapes<a class="headerlink" href="#finding-use-case-shapes" title="Permalink to this headline">#</a></h3>
<p>We can use a couple methods to search the libraries for shapes we might want to use. Let’s start by asking the <code class="docutils literal notranslate"><span class="pre">g36</span></code> library for any system specifications it knows about. This library represents <em>ASHRAE Guideline 36 High-Performance Sequences of Operation for HVAC Systems</em><a class="footnote-reference brackets" href="#id5" id="id2">2</a>. A system specification will specify all of the metadata required for an entity to run control sequences associated with that system type.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from buildingmotif.namespaces import BMOTIF
shapes = g36.get_shape_collection()
for shape in shapes.get_shapes_of_definition_type(BMOTIF[&quot;System_Specification&quot;]):
    print(shape)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>urn:ashrae/g36/4.2/vav-with-reheat/vav-with-reheat
urn:ashrae/g36/4.1/vav-cooling-only/vav-cooling-only
urn:ashrae/g36/4.3/fan-powered/terminal-unit
urn:ashrae/g36/4.3/fan-powered/fan
urn:ashrae/g36/4.3/fan-powered/damper
urn:ashrae/g36/4.5/dual-duct-terminal-unit-with-discharge/terminal-unit
urn:ashrae/g36/4.4/dual-duct-terminal-unit-with-inlet-sensors/terminal-unit
urn:ashrae/g36/4.8/sz-vav-ahu/sz-vav-ahu
urn:ashrae/g36/components/cooling_damper
urn:ashrae/g36/components/heating_damper
urn:ashrae/g36/4.6/mz-vav-ahu/AHU
urn:ashrae/g36/4.6/mz-vav-ahu/supply-fan
urn:ashrae/g36/4.6/mz-vav-ahu/return-damper
urn:ashrae/g36/4.6/mz-vav-ahu/heating-coil
urn:ashrae/g36/4.6/mz-vav-ahu/cooling-coil
</pre></div>
</div>
</div>
</div>
<p>The model represents the Small Office Commercial Prototype Building model, which has single zone packaged AHUs, so we’re interested in validating it against Section 4.8 of Guideline 36 for single zone variable air volume (VAV) AHUs.</p>
<!-- Let's append a reference to that shape in the manifest file.
```{code-cell}
with open("tutorial2_manifest.ttl", "a") as f:
    f.write("""
:sz-vav-ahu-control-sequences a sh:NodeShape ;
    sh:message "AHUs must match the single-zone VAV AHU shape" ;
    sh:targetClass brick:AHU ;
    sh:node <urn:ashrae/g36/4.8/sz-vav-ahu/sz-vav-ahu> .
""")
``` -->
</section>
<section id="id3">
<h3>Validating the Model<a class="headerlink" href="#id3" title="Permalink to this headline">#</a></h3>
<!-- We can now borrow the same code from before and re-run it to re-validate the model:

```{code-cell}
# load manifest into BuildingMOTIF as its own library!
manifest = Library.load(ontology_graph="tutorial2_manifest.ttl")

# gather these into a list for ease of use
shape_collections = [
    brick.get_shape_collection(),
    constraints.get_shape_collection(),
    manifest.get_shape_collection(),
    g36.get_shape_collection(),
]

# pass a list of shape collections to .validate()
validation_result = model.validate(shape_collections)
print(f"Model is valid? {validation_result.valid}")
``` -->
<p>As shown in the previous section, the AHU fails validation because it doesn’t match the <code class="docutils literal notranslate"><span class="pre">sz-vav-ahu-control-sequences</span></code> requirements. Take a look at the first bit of output, which is the official SHACL validation report text format. These aren’t very understandable but BuildingMOTIF can make this output more interpretable!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># SHACL validation report
print(validation_result.report_string)

# separator
print(&quot;-&quot;*79)

# BuildingMOTIF output
print(&quot;Model is invalid for these reasons:&quot;)
for diff in validation_result.diffset:
    print(f&quot; - {diff.reason()}&quot;)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Validation Report
Conforms: False
Results (1):
Constraint Violation in QualifiedValueShapeConstraintComponent (http://www.w3.org/ns/shacl#QualifiedMinCountConstraintComponent):
	Severity: sh:Violation
	Source Shape: [ sh:path brick:hasPart ; sh:qualifiedMaxCount Literal(&quot;1&quot;, datatype=xsd:integer) ; sh:qualifiedMinCount Literal(&quot;1&quot;, datatype=xsd:integer) ; sh:qualifiedValueShape [ sh:node &lt;urn:ashrae/g36/4.8/sz-vav-ahu/sa-fan&gt; ] ]
	Focus Node: &lt;urn:bldg/Core_ZN-PSC_AC&gt;
	Result Path: brick:hasPart

-------------------------------------------------------------------------------
Model is invalid for these reasons:
 - urn:bldg/Core_ZN-PSC_AC needs between 1 and 1 instances of urn:ashrae/g36/4.8/sz-vav-ahu/sa-fan on path https://brickschema.org/schema/Brick#hasPart
</pre></div>
</div>
</div>
</div>
<p>The model is failing because the AHU doesn’t have the minimum number of supply fans associated with it. We <em>could</em> add the fan explicitly by adding those triples to the model like we’ve done previously, but we can also ask BuildingMOTIF to generate new templates that explicitly prompt us for the missing information. We’ll cover this feature in the next tutorial so let’s save the model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>#save model
model.graph.serialize(destination=&quot;tutorial2_model.ttl&quot;)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Graph identifier=d5fb72fa-1761-4748-84fb-bfebce410d3d (&lt;class &#39;rdflib.graph.Graph&#39;&gt;)&gt;
</pre></div>
</div>
</div>
</div>
<hr class="footnotes docutils" />
<dl class="footnote brackets">
<dt class="label" id="id4"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p><a class="reference external" href="https://www.w3.org/TR/shacl/">https://www.w3.org/TR/shacl/</a></p>
</dd>
<dt class="label" id="id5"><span class="brackets"><a class="fn-backref" href="#id2">2</a></span></dt>
<dd><p><a class="reference external" href="https://www.ashrae.org/technical-resources/ashrae-standards-and-guidelines">https://www.ashrae.org/technical-resources/ashrae-standards-and-guidelines</a></p>
</dd>
</dl>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./tutorials"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="model_creation.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Model Creation</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="model_correction.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Model Correction</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By NREL<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>